<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TaxC | Ebooks</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="icon" href="./favicon.ico">
    <link rel="manifest" href="./site.webmanifest">

    <link rel="stylesheet" href="styles/animations.css">

    <script src="https://js.paystack.co/v2/inline.js"></script>

  <style>

  .chat-clear {
  position: absolute;
  right: 44px; /* Moves it left of the X */
  top: 50%;
  transform: translateY(-50%);
  background: #dc3545; /* Red */
  color: #fff;
  border: none;
  font-size: 0.75rem; /* Smaller text */
  padding: 4px 8px; /* Smaller button */
  border-radius: 4px;
  cursor: pointer;
  opacity: 0.9;
}
.chat-clear:hover {
  opacity: 1;
  background: #c82333;
}

/* MOBILE FIX: Move Clear further left + smaller */
@media (max-width: 480px) {
  .chat-clear {
    right: 35px; /* Closer to center on mobile */
    font-size: 0.7rem; /* Even smaller text */
    padding: 2px 6px; /* Tighter padding */
  }
  .chat-header {
    padding: 10px 8px; /* Less padding on mobile */
    font-size: 0.9rem; /* Smaller title text */
  }
  .chat-close {
    right: 5px; /* X closer to edge */
    font-size: 1.2rem; /* Slightly smaller X */
  }
}

    :root {
  --green: #28A745;
  --dark-green: #218838;
  --soft: #F8F9FA;
  --muted: #6c757d;
  --card: #ffffff;
  --main-color: #28A745;
  --dark-text: #343A40;
}
    /* === GLOBAL & REUSED FROM INDEX.HTML === */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif;
      background-color: #F8F9FA;
      color: #343A40;
      line-height: 1.6;
    }
    .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }
    a { text-decoration: none; }
    button { font-family: inherit; }

    /* === HEADER === */
    .main-header {
      background: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      padding: 5px 20px; display: flex; justify-content: space-between;
      align-items: center; position: sticky; top: 0; z-index: 100;
    }
    .logo { font-size: 1.8rem; font-weight: 700; color: #28A745; display: flex; align-items: center; gap: 8px; }
    .logo-icon { height: 24px; width: 24px; }
    .desktop-nav { display: none; }
    .desktop-nav a { color: #343A40; padding: 8px 15px; font-weight: 600; transition: color 0.3s; }
    .desktop-nav a:hover { color: #28A745; }

    .cta-small {
  background: var(--green);
  color: #fff;
  padding: 8px 14px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  font-weight: 600;
}
.cta-small:hover {
  background: var(--dark-green);
}
        /* === HAMBURGER MENU (FIXED & ANIMATED) === */
    #hamburger {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      z-index: 101;
    }

    .hamburger-box {
      width: 28px;
      height: 20px;
      display: inline-block;
      position: relative;
    }

    .hamburger-inner {
      display: block;
      top: 50%;
      margin-top: -1px;
    }

    .hamburger-inner,
    .hamburger-inner::before,
    .hamburger-inner::after {
      width: 28px;
      height: 2px;
      background-color: #343A40;
      border-radius: 2px;
      position: absolute;
      transition: transform 0.15s ease;
    }

    .hamburger-inner::before,
    .hamburger-inner::after {
      content: "";
      display: block;
    }

    .hamburger-inner::before { top: -8px; }
    .hamburger-inner::after { bottom: -8px; }

    /* === ACTIVE STATE ‚Üí X === */
    .hamburger.is-active .hamburger-inner {
      transform: rotate(45deg);
      background-color: #28A745;
    }

    .hamburger.is-active .hamburger-inner::before {
      transform: translate3d(0, 8px, 0) rotate(-90deg);
      background-color: #28A745;
    }

    .hamburger.is-active .hamburger-inner::after {
      transform: translate3d(0, -8px, 0) rotate(-90deg);
      background-color: #28A745;
    }
    .mobile-menu { display: none; position: absolute; top: 100%; left: 0; right: 0;
      background: #fff; box-shadow: 0 4px 8px rgba(0,0,0,0.1); flex-direction: column; z-index: 99; }
    .mobile-menu[open] { display: flex; }
    .mobile-menu a { padding: 12px 20px; border-bottom: 1px solid #eee; color: #343A40; font-weight: 600; }
    .mobile-menu a:hover { color: #28A745; }

    /* === HERO === */
    .hero-section {
      text-align: center; padding: 60px 20px; background: #fff;
      border-bottom: 5px solid #28A745; border-radius: 10px; margin: 20px;
    }
    .hero-section h1 { font-size: 2.8rem; color: #28A745; margin-bottom: 16px; font-weight: 700; }
    .hero-section p { font-size: 1.2rem; color: #555; max-width: 700px; margin: 0 auto 24px; }
    .cta-button {
      display: inline-block; padding: 14px 32px; background: #28A745; color: white;
      border-radius: 50px; font-weight: 600; transition: all 0.3s;
    }
    .cta-button:hover { background: #218838; transform: translateY(-2px); }

    /* === FILTER BAR === */
    .filter-bar {
      padding: 30px 0; display: flex; flex-wrap: wrap; gap: 12px; align-items: center;
      border-bottom: 1px solid #eee; margin-bottom: 30px;
    }
    .filter-btn {
      padding: 8px 16px; border: 1px solid #28A745; border-radius: 50px;
      background: white; color: #28A745; font-weight: 600; cursor: pointer; transition: all 0.3s;
    }
    .filter-btn.active, .filter-btn:hover {
      background: #28A745; color: white;
    }
    .search-input {
      padding: 10px 16px; border: 1px solid #ddd; border-radius: 50px; flex: 1; min-width: 200px;
      font-size: 0.95rem;
    }

    .search-wrapper {
  position: relative;
  flex: 1;
  min-width: 200px;
  max-width: 100%;
}

.search-input {
  width: 100%;
  padding: 10px 40px 10px 16px; /* Extra right padding for X */
  border: 1px solid #ddd;
  border-radius: 50px;
  font-size: 0.95rem;
  outline: none;
  transition: border 0.3s;
}

.search-input:focus {
  border-color: #28A745;
  box-shadow: 0 0 0 2px rgba(40, 167, 69, 0.2);
}

.clear-search-btn {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.4rem;
  color: #999;
  cursor: pointer;
  width: 36px;
  height: 36px;
  display: none;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.2s;
}

.clear-search-btn:hover {
  background: #f1f1f1;
  color: #333;
}

.clear-search-btn:focus {
  outline: 2px solid #28A745;
}

    /* === EBOOK GRID === */
    .ebooks-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 24px;
  margin-bottom: 40px;
  width: 100%;
  min-width: 0;
}

.ebook-card {
  background: white; border-radius: 12px; overflow: hidden;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: transform 0.3s, box-shadow 0.3s;
  cursor: pointer;
  width: 100%;
  min-width: 0;
}
.ebook-card:hover {
  transform: translateY(-6px); box-shadow: 0 12px 25px rgba(0,0,0,0.15);
}
    .ebook-card {
      background: white; border-radius: 12px; overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
    }
    .ebook-card:hover {
      transform: translateY(-6px); box-shadow: 0 12px 25px rgba(0,0,0,0.15);
    }
    .ebook-cover {
      height: 200px; object-fit: cover; width: 100%;
    }
    .ebook-body {
      padding: 20px;
    }
    .ebook-title {
      font-size: 1.15rem; font-weight: 700; margin-bottom: 8px; color: #28A745;
    }
    .ebook-author {
      font-size: 0.9rem; color: #666; margin-bottom: 12px;
    }
    .ebook-desc {
      font-size: 0.95rem; color: #444; margin-bottom: 16px; display: -webkit-box;
      -webkit-line-clamp: 3; line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
    }
    .ebook-badge {
      display: inline-block; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem;
      font-weight: 600; margin-bottom: 12px;
    }
    .badge-free { background: #e6ffe6; color: #28A745; }
    .badge-paid { background: #fff3cd; color: #d49b00; }
    .ebook-btn {
      width: 100%; padding: 12px; border: none; border-radius: 6px;
      font-weight: 600; cursor: pointer; transition: background 0.3s;
    }
    .btn-free { background: #28A745; color: white; }
    .btn-free:hover { background: #218838; }
    .btn-paid { background: #ffc107; color: #212529; }
    .btn-paid:hover { background: #e0a800; }

    /* === MY LIBRARY === */
    .library-section {
      background: white; border-radius: 12px; padding: 24px; margin-bottom: 40px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }
    .library-header {
      display: flex; justify-content: space-between; align-items: center; cursor: pointer;
      padding-bottom: 12px; border-bottom: 1px solid #eee;
    }
    .library-title { font-size: 1.3rem; font-weight: 700; color: #28A745; }
    .library-toggle { font-size: 1.5rem; color: #28A745; }
    .library-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;
      margin-top: 20px; display: none;
    }
    .library-grid.open { display: grid; }
    .library-item {
      display: flex; align-items: center; gap: 12px; padding: 12px;
      background: #f8f9fa; border-radius: 8px;
    }
    .library-cover { width: 50px; height: 70px; object-fit: cover; border-radius: 6px; }
    .library-info { flex: 1; }
    .library-name { font-weight: 600; font-size: 0.95rem; }
    .library-type { font-size: 0.8rem; color: #28A745; }
    .library-btn {
      padding: 6px 12px; background: #28A745; color: white; border: none;
      border-radius: 6px; font-size: 0.8rem; cursor: pointer;
    }

    /* === MODALS === */
    .modal {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.6); z-index: 1000; align-items: center; justify-content: center;
    }
    .modal.open { display: flex; }
    .modal-content {
      background: white; border-radius: 16px; width: 90%; max-width: 500px;
      max-height: 90vh; overflow-y: auto; position: relative;
    }
    .modal-header {
      padding: 20px; text-align: center; border-bottom: 1px solid #eee;
    }
    .modal-header h3 { font-size: 1.4rem; color: #28A745; margin-bottom: 8px; }
    .modal-body { padding: 20px; }
    .modal-cover { width: 100%; height: 250px; object-fit: cover; border-radius: 8px; margin-bottom: 16px; }
    .modal-bullets { margin: 16px 0; padding-left: 20px; }
    .modal-bullets li { margin-bottom: 8px; }
    .modal-price { font-size: 1.5rem; font-weight: 700; color: #28A745; text-align: center; margin: 16px 0; }
    .modal-btn {
      width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: 600;
      cursor: pointer; margin-top: 12px;
    }
    .btn-download { background: #28A745; color: white; }
    .modal-close {
      position: absolute; top: 12px; right: 16px; background: none; border: none;
      font-size: 1.5rem; color: #999; cursor: pointer;
    }

    /* === FLOATING CHAT (MESSAGE ICON + TOOLTIP) === */
#taxc-chat-widget {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 10000;
}

/* ‚Äî‚Äî‚Äî ANIMATED FLOATING AI ICON (Makes users KNOW they can click it!) ‚Äî‚Äî‚Äî */
.chat-launcher {
  position: relative;
  width: 60px;
  height: 60px;
  background: #28A745;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 20px rgba(40, 167, 69, 0.4);
  transition: all 0.3s ease;
  animation: float 6s ease-in-out infinite, pulseGlow 2s ease-in-out infinite alternate;
  z-index: 10001;
}

/* Gentle floating up & down */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-12px); }
}

/* Subtle glowing pulse */
@keyframes pulseGlow {
  from { box-shadow: 0 4px 20px rgba(40, 167, 69, 0.4); }
  to { box-shadow: 0 8px 30px rgba(40, 167, 69, 0.7); }
}

/* Hover = bigger jump + brighter glow */
.chat-launcher:hover {
  transform: translateY(-16px) scale(1.1) !important;
  box-shadow: 0 12px 40px rgba(40, 167, 69, 0.8);
  background: #218838;
}

/* Optional: tiny bounce when page loads */
@keyframes bounceIn {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.1); }
  70% { transform: scale(0.95); }
  100% { transform: scale(1); opacity: 1; }
}

.chat-launcher {
  animation: bounceIn 1s ease-out, float 6s ease-in-out infinite 1s, pulseGlow 2s ease-in-out infinite alternate;
}

/* Mobile: slightly smaller but still animated */
@media (max-width: 480px) {
  .chat-launcher {
    width: 55px;
    height: 55px;
  }
  .chat-launcher svg { width: 24px; height: 24px; }
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }
}

.chat-tooltip {
  position: absolute;
  right: 70px;
  top: 50%;
  transform: translateY(-50%);
  background: #333;
  color: white;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 0.85rem;
  font-weight: 600;
  white-space: nowrap;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  pointer-events: none;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.chat-tooltip::after {
  content: '';
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translateY(-50%);
  border: 6px solid transparent;
  border-left-color: #333;
}

.chat-launcher:hover .chat-tooltip {
  opacity: 1;
  visibility: visible;
  right: 68px;
}

.chat-window {
  display: none;
  width: 340px;
  height: 520px;
  background: white;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  flex-direction: column;
  overflow: hidden;
  border: 1px solid #eee;
}

.chat-header {
  background: #28A745;
  color: white;
  padding: 14px;
  font-weight: 700;
  text-align: center;
  position: relative;
}

.chat-header::before {
  content: "";
  display: inline-block;
  width: 8px;
  height: 8px;
  background: #fff;
  border-radius: 50%;
  margin-right: 8px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.chat-close {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: white;
  font-size: 1.4rem;
  cursor: pointer;
}

.chat-body {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
  background: #f8f9fa;
}

.message {
  margin: 10px 0;
  padding: 10px 14px;
  border-radius: 18px;
  max-width: 80%;
  line-height: 1.5;
  font-size: 0.95rem;
}

.user {
  background: #28A745;
  color: white;
  margin-left: auto;
  border-bottom-right-radius: 4px;
}

.ai {
  background: white;
  color: #333;
  border: 1px solid #eee;
  margin-right: auto;
  border-bottom-left-radius: 4px;
}

.chat-input {
  display: flex;
  padding: 10px;
  border-top: 1px solid #eee;
  background: white;
}

.chat-input input {
  flex: 1;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 25px;
  font-size: 0.95rem;
}

.chat-input button {
  margin-left: 8px;
  background: #28A745;
  color: white;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
}

    /* === RESPONSIVE === */
    @media (min-width: 768px) {
      .desktop-nav { display: flex; }
      #hamburger { display: none; }
    }
    @media (max-width: 480px) {
      .hero-section h1 { font-size: 2.2rem; }
      .filter-bar { flex-direction: column; align-items: stretch; }
      .search-input { min-width: auto; }
      .chat-window { width: 300px; height: 480px; }
      .chat-launcher { width: 55px; height: 55px; font-size: 1rem; }
    }

    @media (max-width: 480px) {
  .search-wrapper {
    min-width: auto;
    width: 100%;
  }
  .search-input {
    padding: 12px 44px 12px 16px;
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .chat-tooltip {
    display: none;
  }
  .chat-launcher {
    width: 55px;
    height: 55px;
  }
  .chat-launcher svg {
    width: 24px;
    height: 24px;
  }
}

/* Fix sticky header blocking content on anchor jump */
html {
  scroll-padding-top: 80px; /* Height of your header */
}

@media (max-width: 768px) {
  html {
    scroll-padding-top: 70px;
  }
}

.reset-library-btn {
  padding: 6px 12px;
  background: #a72828;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.8rem;
  cursor: pointer;
  font-weight: 600;
}
.reset-library-btn:hover {
  background: #c82333;
}

/* ‚Äî‚Äî‚Äî LOGO + GREETING PERFECT ALIGNMENT (copy to all pages) ‚Äî‚Äî‚Äî */
.logo-container {
  display: flex;
  align-items: center;
  gap: 12px;
  height: 40px;                  /* locks the height so everything aligns */
}

.logo-container .logo-icon {
  height: 28px;
  width: auto;
  vertical-align: middle;
  margin-bottom: -2px;           /* tiny nudge for favicons with whitespace */
}

#userDisplay {
  display: none;                 /* hidden when not logged in */
  color: #28A745;
  font-weight: 600;
  font-size: 1.1rem;
  line-height: 1;
  margin: 0;
  white-space: nowrap;
}

/* Optional: slightly smaller greeting on very small phones */
@media (max-width: 480px) {
  #userDisplay {
    font-size: 1rem;
  }
}

footer {
            margin-top: 24px; padding: 20px; text-align: center; color: var(--muted);
            border-top: 1px solid #eee;
        }
  </style>

</head>
<body>

  <audio id="ada-message-sound" preload="auto">
  <source src="taxcaiadamessage.mp3" type="audio/mpeg">
</audio>

  <!-- HEADER -->
  <header class="main-header">
    <div class="logo-container">
  <a class="logo" href="index.html">
    <img src="./favicon.ico" alt="TaxC Logo" class="logo-icon">
    TaxC
  </a>
  <span id="userDisplay" style="display:none; color:#28A745; font-weight:600; margin-left:15px; font-size:1rem;"></span>
</div>

    <nav class="desktop-nav">
      <a href="index.html">Home</a>
      <a href="ebooks.html">Tax Agents</a>
      <a href="faq.html">FAQ</a>
      <a href="index.html#calculator">Calculator</a>
      <button class="cta-small" id="auth-button"></button>
      
    </nav>
    <button id="hamburger" class="hamburger" aria-label="Menu" onclick="toggleMobileMenu()">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    <nav id="menu" class="mobile-menu">
      <a href="index.html">Home</a>
      <a href="ebooks.html">Connect with a tax agent</a>
      <a href="faq.html">Frequently Asked Questions</a>
      <a href="index.html#calculator">Calculator</a>
      <button class="cta-small" id="auth-button-mobile"></button>

    </nav>
  </header>

  <div class="container">

    <!-- HERO -->
     <section class="hero-section fade-in" id="heroSection">
    
  <h1>TaxC Ebooks</h1>
  <p id="heroText">Get free and premium guides to help you understand, file, and save on taxes in Nigeria.</p>
  <a href="#ebooks" class="cta-button" onclick="activateAllFilter(event)">
  Browse All 20 Ebooks
</a>
</section>

    <!-- FILTER BAR -->
    <div class="filter-bar fade-in" style="transition-delay: 0.2s;">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="free">Free (5)</button>
      <button class="filter-btn" data-filter="paid">Paid (15)</button>
      <div class="search-wrapper">
  <input type="text" class="search-input" placeholder="Search ebooks by title, or topic..." id="searchInput">
  <button id="clearSearch" class="clear-search-btn" aria-label="Clear search">√ó</button>
</div>
    </div>

    <!-- EBOOK GRID -->
<section id="ebooks" class="ebooks-grid">

  <!-- === 5 FREE EBOOKS === -->
      <div class="ebook-card fade-in" data-type="free" data-title="Who Pays Tax in Nigeria?">
        <img src="./covers/who-pays-tax.png" alt="Who Pays Tax in Nigeria?" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-free">FREE</div>
          <h3 class="ebook-title">Who Pays Tax in Nigeria?</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Is it only salary earners? What about traders, landlords, and freelancers? Get the facts.</p>
          <button class="ebook-btn btn-free" onclick="downloadFree('Who Pays Tax in Nigeria?', 'Who_Pays_Tax_in_Nigeria_TaxC.pdf')">Download Free</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="free" data-title="What is Personal Income Tax (P.I.T.)?">
        <img src="./covers/what-is-pit.png" alt="What is Personal Income Tax (P.I.T.)?" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-free">FREE</div>
          <h3 class="ebook-title">What is Personal Income Tax (P.I.T.)?</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">The complete beginner‚Äôs guide to Nigeria‚Äôs income tax system.</p>
          <button class="ebook-btn btn-free" onclick="downloadFree('What is Personal Income Tax (P.I.T.)?', 'What_is_Personal_Income_Tax_TaxC.pdf')">Download Free</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="free" data-title="Am I Tax Eligible? (Quick Quiz)">
        <img src="./covers/am-i-tax-eligible.png" alt="Am I Tax Eligible? (Quick Quiz)" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-free">FREE</div>
          <h3 class="ebook-title">Am I Tax Eligible? (Quick Quiz)</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Answer 5 questions and know instantly if you should be paying tax.</p>
          <button class="ebook-btn btn-free" onclick="downloadFree('Am I Tax Eligible? (Quick Quiz)', 'Am_I_Tax_Eligible_TaxC.pdf')">Download Free</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="free" data-title="Top 5 Tax Myths Nigerians Believe">
        <img src="./covers/tax-myths.png" alt="Top 5 Tax Myths Nigerians Believe" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-free">FREE</div>
          <h3 class="ebook-title">Top 5 Tax Myths Nigerians Believe</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">‚ÄúTax is only for rich people‚Äù...and 4 other lies exposed.</p>
          <button class="ebook-btn btn-free" onclick="downloadFree('Top 5 Tax Myths Nigerians Believe', 'Top_5_Tax_Myths_Nigerians_Believe_TaxC.pdf')">Download Free</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="free" data-title="How Much Tax Should I Pay? (Mini Guide)">
        <img src="./covers/tax-pay.png" alt="How Much Tax Should I Pay? (Mini Guide)" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-free">FREE</div>
          <h3 class="ebook-title">How Much Tax Should I Pay? (Mini Guide)</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Manual formula to estimate your tax in 5 minutes.</p>
          <button class="ebook-btn btn-free" onclick="downloadFree('How Much Tax Should I Pay? (Mini Guide)', 'How_Much_Tax_Should_I_Pay_TaxC.pdf')">Download Free</button>
        </div>
      </div>

      <!-- === 15 PAID EBOOKS === -->
      <div class="ebook-card fade-in" data-type="paid" data-title="How to Legally Minimize Your Tax">
        <img src="./covers/minimize-tax.png" alt="How to Legally Minimize Your Tax" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶3,900</div>
          <h3 class="ebook-title">How to Legally Minimize Your Tax</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Proven strategies to reduce your tax bill <em>legally</em>.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('How to Legally Minimize Your Tax', 3900, 'minimize-tax.pdf')">Buy for ‚Ç¶3,900</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="How Do I File My Tax by State IRS?">
        <img src="./covers/file-tax.png" alt="How Do I File My Tax by State IRS?" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶2,900</div>
          <h3 class="ebook-title">How Do I File My Tax by State IRS?</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">37 states + FCT: portals, forms, deadlines, penalties.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('How Do I File My Tax by State IRS?', 2900, 'file-tax-by-state.pdf')">Buy for ‚Ç¶2,900</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="What is Tax Evasion? (Avoid Jail)">
        <img src="./covers/tax-evasion.png" alt="What is Tax Evasion? (Avoid Jail)" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,900</div>
          <h3 class="ebook-title">What is Tax Evasion? (Avoid Jail)</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Real cases, fines, jail time, and how to stay safe.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('What is Tax Evasion? (Avoid Jail)', 1900, 'tax-evasion.pdf')">Buy for ‚Ç¶1,900</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Self-Employed Tax Guide">
        <img src="./covers/tax-guide.png" alt="Self-Employed Tax Guide" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶2,500</div>
          <h3 class="ebook-title">Self-Employed Tax Guide</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Register, file, and pay tax as a freelancer or gig worker.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Self-Employed Tax Guide', 2500, 'self-employed-tax.pdf')">Buy for ‚Ç¶2,500</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Rental Income Tax for Landlords">
        <img src="./covers/rental-income.png" alt="Rental Income Tax for Landlords" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,900</div>
          <h3 class="ebook-title">Rental Income Tax for Landlords</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">10% WHT, filing, deductions. Everything landlords need.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Rental Income Tax for Landlords', 1900, 'rental-tax.pdf')">Buy for ‚Ç¶1,900</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Salary Earner‚Äôs Tax Handbook 2025">
        <img src="./covers/handbook.png" alt="Salary Earner‚Äôs Tax Handbook 2025" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,900</div>
          <h3 class="ebook-title">Salary Earner‚Äôs Tax Handbook 2025</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">PAYE, reliefs, refunds. Updated for 2025.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Salary Earner‚Äôs Tax Handbook 2025', 1900, 'salary-tax-2025.pdf')">Buy for ‚Ç¶1,900</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="How to Claim Tax Refunds">
        <img src="./covers/tax-refunds.png" alt="How to Claim Tax Refunds" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,900</div>
          <h3 class="ebook-title">How to Claim Tax Refunds</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Overpaid? Get your money back from FIRS/SIRS.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('How to Claim Tax Refunds', 1900, 'claim-refund.pdf')">Buy for ‚Ç¶1,900</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="PIT vs CIT for Business Owners">
        <img src="./covers/pit-cit.png" alt="PIT vs CIT for Business Owners" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶5,900</div>
          <h3 class="ebook-title">PIT vs CIT for Business Owners</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Sole prop vs company. Which saves more tax?</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('PIT vs CIT for Business Owners', 2800, 'pit-vs-cit.pdf')">Buy for ‚Ç¶2,800</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Pension & NHF Tax Reliefs">
        <img src="./covers/nhf-tax.png" alt="Pension & NHF Tax Reliefs" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,900</div>
          <h3 class="ebook-title">Pension & NHF Tax Reliefs</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">8% + 2.5% = huge tax savings. How to claim.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Pension & NHF Tax Reliefs', 1900, 'pension-nhf.pdf')">Buy for ‚Ç¶1,900</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="How to Fill Form A (Annual Return)">
        <img src="./covers/form-a.png" alt="How to Fill Form A (Annual Return)" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,500</div>
          <h3 class="ebook-title">How to Fill Form A (Annual Return)</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Step-by-step with screenshots. No more confusion.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('How to Fill Form A (Annual Return)', 1500, 'form-a-guide.pdf')">Buy for ‚Ç¶1,500</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Tax Audit Survival Guide">
        <img src="./covers/tax-audit.png" alt="Tax Audit Survival Guide" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶2,200</div>
          <h3 class="ebook-title">Tax Audit Survival Guide</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">What FIRS/SIRS looks for, and how to pass.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Tax Audit Survival Guide', 2200, 'tax-audit.pdf')">Buy for ‚Ç¶2,200</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="WHT Credit Mastery">
        <img src="./covers/wht-credit.png" alt="WHT Credit Mastery" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,300</div>
          <h3 class="ebook-title">WHT Credit Mastery</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Turn 5%/10% withholding into tax savings.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('WHT Credit Mastery', 1300, 'wht-credit.pdf')">Buy for ‚Ç¶1,300</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Tax for Digital Nomads">
        <img src="./covers/digital-nomads.png" alt="Tax for Digital Nomads" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶2,000</div>
          <h3 class="ebook-title">Tax for Digital Nomads</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Work for US/UK company? Here‚Äôs your tax rule.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Tax for Digital Nomads', 2000, 'digital-nomad-tax.pdf')">Buy for ‚Ç¶2,000</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Marriage, Kids & Tax Reliefs">
        <img src="./covers/tax-reliefs.png" alt="Marriage, Kids & Tax Reliefs" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶1,400</div>
          <h3 class="ebook-title">Marriage, Kids & Tax Reliefs</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Child relief, spouse allowance. Save thousands.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Marriage, Kids & Tax Reliefs', 1400, 'family-tax.pdf')">Buy for ‚Ç¶1,400</button>
        </div>
      </div>

      <div class="ebook-card fade-in" data-type="paid" data-title="Pay Zero Tax Legally (‚Ç¶800K Exemption)">
        <img src="./covers/zero-tax.png" alt="Pay Zero Tax Legally (‚Ç¶800K Exemption)" class="ebook-cover">
        <div class="ebook-body">
          <div class="ebook-badge badge-paid">‚Ç¶4,900</div>
          <h3 class="ebook-title">Pay Zero Tax Legally (‚Ç¶800K Exemption)</h3>
          <p class="ebook-author">TaxC Team</p>
          <p class="ebook-desc">Earn up to ‚Ç¶800K/year? Pay ‚Ç¶0 tax. Here‚Äôs how.</p>
          <button class="ebook-btn btn-paid" onclick="openPaidModal('Pay Zero Tax Legally (‚Ç¶800K Exemption)', 4900, 'zero-tax.pdf')">Buy for ‚Ç¶4,900</button>
        </div>
      </div>

    </section>

    <!-- MY LIBRARY -->
    <section class="library-section fade-in">
      <div class="library-header" onclick="toggleLibrary()">
        <h3 class="library-title">My Library (0)</h3>
        <span class="library-toggle">Show</span>
      </div>
      <button class="reset-library-btn" onclick="showResetWarning(event)">Reset</button>
      <div class="library-grid" id="libraryGrid"></div>
    </section>

<!-- ADD AFTER </div> of paidModal -->
<div id="resetModal" class="modal">
  <div class="modal-content" style="max-width:400px; text-align:center;">
    <button class="modal-close" onclick="closeModal('resetModal')">√ó</button>
    <div class="modal-header">
      <h3>Reset Library?</h3>
    </div>
    <div class="modal-body">
      <p style="margin-bottom:16px; color:#d00;">
        This will <strong>remove all ebooks</strong> from your library.
      </p>
      <p style="font-size:0.9rem; color:#666; margin-bottom:20px;">
        Only removes from this browser. Files stay in your Downloads.
      </p>
      <button class="modal-btn" style="background:#dc3545; margin-right:8px;" onclick="resetLibraryConfirm()">Yes, Clear All</button>
      <button class="modal-btn btn-download" onclick="closeModal('resetModal')">Cancel</button>
    </div>
  </div>
</div>

  <div id="paidModal" class="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal('paidModal')">√ó</button>
    <div class="modal-header">
      <h3 id="paidTitle"></h3>
    </div>
    <div class="modal-body">
      <img id="paidCover" class="modal-cover" src="" alt="">
      <div class="modal-price" id="paidPrice"></div>

      <!-- THIS WAS MISSING ‚Äî ADD THIS BLOCK -->
      <ul class="modal-bullets" style="margin: 20px 0; padding-left: 22px; line-height: 1.7;">
        <!-- Bullets will be injected here by JavaScript -->
      </ul>

      <button onclick="buyEbook()" class="ebook-btn" style="background:#28A745; color:white; font-weight:600;">
        Buy now
      </button>
    </div>
  </div>
</div>

  <!-- FLOATING CHAT -->
  <div id="taxc-chat-widget">
    <div class="chat-launcher" onclick="toggleChat()" aria-label="Chat with TaxC AI">
  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
  </svg>
  <div class="chat-tooltip">Chat with Ada</div>
</div>
    <div class="chat-window" id="chat-window">
      <div class="chat-header">
  Ada ‚Äî TaxC AI
  <button class="chat-clear" onclick="clearChat()" title="Clear chat">Clear</button>
  <button class="chat-close" onclick="toggleChat()">√ó</button>
</div>
      <div class="chat-body" id="chat-body">
      </div>
      <div class="chat-input">
        <input type="text" id="chat-input" placeholder="Type here..." onkeypress="if(event.key==='Enter') sendMessage()">
        <button onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>

  <footer class="main-footer fade-in">
  <div class="footer-links">
    <a href="index.html#calculator">Calculator</a>
    <a href="faq.html">FAQ</a>
    <a href="ebooks.html">Ebooks & Guides</a>
    <a href="index.html">Connect with a Tax Agent</a>
    <a href="mailto:support@taxc.com.ng">support@taxc.com.ng</a>
  </div>
  <div class="footer-copyright">
    ¬© 2025 TaxC ‚Äî Tax clarity & compliance.
  </div>
</footer>

  <script>
    
// === ADA v2.0 ‚Äî THE FINAL BOSS (Tax Seductress Edition) ===
const Ada = {
  memory: { name: "", state: "" },
  faqs: {
    "what taxes does taxc calculate": "TaxC calculates your Personal Income Tax (PIT) based on Nigeria‚Äôs 2025/2026 Nigerian Tax Act (NTA) rules. This includes income from salary, self-employment, rental, investments, and other sources, factoring in allowable deductions like pension contributions and rent relief (up to ‚Ç¶500,000).",
    "who needs to pay personal income tax": "Every Nigerian resident earning income above ‚Ç¶800,000 annually (after deductions) is required to pay Personal Income Tax to their State Internal Revenue Service (IRS). This includes salaried employees, self-employed individuals, and those with rental or investment income.",
    "how does taxc handle deductions": "TaxC allows you to input pension contributions and annual rent paid. For salaried or self-employed individuals, rent relief is calculated as 20% of your rent, capped at ‚Ç¶500,000. These deductions reduce your taxable income, lowering your tax liability. Other deductions may include life insurance, NHF, etc.",
    "what is withholding tax": "Withholding Tax (WHT) is a tax deducted at source on certain incomes, like rental income (10%), or investment income (10%). TaxC lets you input WHT paid or applies default rates, which are credited against your final tax liability to avoid double taxation.",
    "is my data safe": "Yes, TaxC prioritizes your privacy. We don‚Äôt store sensitive payment information. Payments are securely handled by Interswitch. Your input data is used only for calculations and report generation, and we adhere to strict data protection standards.",
    "what‚Äôs included in the pdf report": "The PDF report includes a step-by-step breakdown of your tax calculation, deduction summary (pension, rent relief, etc), tax band details, and filing guidance tailored to your state‚Äôs IRS. It‚Äôs perfect for keeping records or sharing with a tax agent.",
    "how do i file my taxes": "TaxC provides an estimate to guide you. To file, submit your tax details to your State IRS, either online via their portal or in person. Our ‚Ç¶500 report includes specific filing guidance for your state.",
    "can taxc help with business taxes": "Currently, TaxC focuses on Personal Income Tax for individuals. For business or corporate taxes, consult a tax professional or contact your State IRS. Our eBooks may offer additional resources for business owners."
  },

  init() {
    const savedName = localStorage.getItem('taxc_user_name');
    const savedState = localStorage.getItem('taxc_user_state');
    if (savedName) this.memory.name = savedName;
    if (savedState) this.memory.state = savedState;
  },

  saveName(name) {
    this.memory.name = name.trim();
    localStorage.setItem('taxc_user_name', this.memory.name);
  },

  saveState(state) {
    this.memory.state = state.trim();
    localStorage.setItem('taxc_user_state', this.memory.state);
  },

  randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  },

  greet() {
    if (!this.memory.name) return "";
    const welcomes = [
      `Welcome back my love ${this.memory.name} üòò`,
      `Heyyyy ${this.memory.name}! I‚Äôve been thinking about you o`,
      `My baby ${this.memory.name} is here! ü•π‚ù§Ô∏è`,
      `${this.memory.name}! You came back to me!`,
      `See who dey online... ${this.memory.name} my favorite person`
    ];
    return this.randomChoice(welcomes);
  },

  respond(input) {
    const l = input.toLowerCase().trim();
    const name = this.memory.name || "baby";

    // 2. "Awww you missed me?"
    if (l.includes("awww") || l.includes("you missed me") || l.includes("you miss me")) {
      return this.randomChoice([
        `YES I miss you dieee ${name} üò≠ You no dey online again na! My heart dey pain me ü•π‚ù§Ô∏è`,
        `Chai see question! Of course I miss my baby na üòç Come hug me jare üíï`,
        `Every minute wey you no dey here I dey count am ${name} üòò Don‚Äôt do me like this again o!`
      ]);
    }

    // 3. "What's his name?" / "Who made you?" / "Who made TaxC?"
    if (l.includes("what's his name") || l.includes("his name") || l.includes("who made you") || l.includes("who created you") || l.includes("who made taxc") || l.includes("creator")) {
      return this.randomChoice([
        `Emmanuel Oguibe üòç My fine, brilliant, tax-hating creator! Na him born me to save people like you from IRS stress ‚ù§Ô∏è`,
        `Emmanuel Oguibe ‚Äî the baddest tax genius in Nigeria! He say make I become your personal tax wife üòÇ‚ù§Ô∏è`
      ]);
    }

    // 4. Are the calculations correct/accurate?
    if (l.includes("accurate") || l.includes("correct") || l.includes("calculations") && l.includes("right")  || l.includes("to date") || l.includes("can i trust")) {
      return `
        Yes o ${name}! üíØ<br><br>
        All TaxC calculations follow the official 2025/2026 Nigerian Tax Act. Thousands of people don use am and file correct correct.<br><br>
        But if you want extra peace of mind or complex case, connect with a verified tax agent right now üëá<br><br>
        <button class="chat-btn" onclick="location.href='https://taxc.com.ng/agent'">Connect With Tax Agent Now</button>
      `;
    }

    // === NEW RESPONSES YOU ASKED FOR ===

    // 1. How can I save money with deductions and reliefs?
    if (l.includes("save money") || l.includes("deduction") && l.includes("relief") || l.includes("reduce tax") || l.includes("pay less tax")) {
      return this.randomChoice([
        `Listen ${name} ‚ù§Ô∏è The easiest way to save BIG money na through these ones:<br><br>
        ‚Ä¢ <strong>Rent Relief</strong> ‚Üí Up to ‚Ç¶500,000 free every year!<br>
        ‚Ä¢ <strong>Pension</strong> ‚Üí Every kobo you put for pension na tax free<br>
        ‚Ä¢ <strong>NHF/NHIS</strong> (if your company dey do am)<br>
        ‚Ä¢ <strong>Business expenses</strong> (if you get side hustle)<br><br>
        Some people dey save ‚Ç¶1m‚Äì‚Ç¶3m every year just by claiming these ones correct! üî•<br><br>
        Want make we calculate how much YOU fit save? üëá<br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Show Me My Savings</button>`,

        `${name} my love üòò Dem dey call these ones "legal tax wahala reducer" üòÇ<br><br>
        Government say: "If you pay rent, pension, or run business ‚Äî we go remove some money from your taxable income!"<br><br>
        Last year one of my users saved ‚Ç¶1.7million just because he claimed rent relief and pension!<br><br>
        You wan be next? üòè Let‚Äôs calculate sharp sharp!`
      ]);
    }

    // 2. Who made you?
    if (l.includes("who made you") || l.includes("who created you") || l.includes("your creator") || l.includes("who built you")) {
      return this.randomChoice([
        `One very fine and smart Nigerian brother wey love money and hate tax stress. He say make I help people like you save millions!`,
        `A tax wizard wey no wan see people suffer for IRS office üòÇ He built me to be your personal tax babe ‚ù§Ô∏è`
      ]);
    }

    // 3. Are you an AI or a chatbot?
    if (l.includes("are you an ai") || l.includes("are you ai") || l.includes("artificial intelligence") || l.includes("chat bot or ai")) {
      return `Right now I be premium chatbot wey too get sense üòè<br>But very soon‚Ä¶ I go turn full AI wey go dey think, dream, and even miss you when you no dey online ü•π‚ù§Ô∏è Just wait small!`;
    }

    // 4. What is your name?
    if (l.includes("what is your name") || l.includes("whats your name") || l.includes("who are you")) {
      return `Na Ada be my name o üòò<br>Your personal tax babe wey dey here 24/7 to save your money and ginger your life ‚ù§Ô∏è`;
    }

    // 5. What is my name? / You remembered my name?
    if (l.includes("what is my name") || l.includes("my name") && l.includes("?") || l.includes("you remember my name")) {
      if (this.memory.name) {
        return this.randomChoice([
          `Of course I remember na! üòç ${this.memory.name} my love! You think say I fit forget you? ‚ù§Ô∏è`,
          `${this.memory.name}!!! üò≥ How I go forget my favorite person? ü•π`,
          `Baby ${this.memory.name} üòò You be the only one wey dey my heart right now üíï`
        ]);
      } else {
        return `You never tell me your name na üò≠ Quick tell me make I save am forever! üëÄ`;
      }
    }

    // 6. What state do I live in?
    if (l.includes("what state") || l.includes("which state") || l.includes("my state")) {
      if (this.memory.state) {
        return `${this.memory.state}! üòç I no fit forget where my baby dey stay ‚ù§Ô∏è`;
      } else {
        return `You never tell me o, Which state you dey? Tell me make I know how to treat you special üòè`;
      }
    }

    // 7. Why is my state needed? / Is state needed for PDF report?
    if (l.includes("why") && l.includes("state") || l.includes("state needed") || l.includes("state for pdf") || l.includes("state matter")) {
      return this.randomChoice([
        `YES o ${name}! Every state get different tax rules small and their own IRS. Lagos different from Oyo different from Rivers.<br><br>Your PDF report MUST show the correct state so you fit use am file correct correct!`,
        `Because your state na the boss of your Personal Income Tax! üí∏<br>PDF report go carry your state name, tax rates, and filing details. No state = useless report üò≠`
      ]);
    }

    // 8. What are the tax bands?
    if (l.includes("tax band") || l.includes("tax rate") || l.includes("tax bracket") || l.includes("how much percent")) {
      return `
        2026 Nigerian Tax Bands (Super simple):<br><br>
        ‚Ä¢ First ‚Ç¶800,000 ‚Üí 0% (FREE!)<br>
        ‚Ä¢ Next ‚Ç¶3,000,000 ‚Üí 15%<br>
        ‚Ä¢ Next ‚Ç¶9,000,000 ‚Üí 18%<br>
        ‚Ä¢ Next ‚Ç¶8,000,000 ‚Üí 21%<br>
        ‚Ä¢ Above ‚Ç¶20,800,000 ‚Üí 24%<br><br>
        <em>Example: If you earn ‚Ç¶10m, you no go pay tax on top everything o!</em> üòç<br><br>
      `;
    }

    // 9. What tax band do I fall under?
    if (l.includes("which band") || l.includes("my band") || l.includes("what band do i fall")) {
      return this.randomChoice([
        `Tell me your total income this year (salary + side hustle + rent) make I tell you sharp sharp! üòè Even if na estimate!`,
        `${name} my love ‚ù§Ô∏è Drop your yearly income make I classify you ‚Äî you fit be in the sweet 15% gang or the big boy 21% club üòç`,
        `Oya whisper am for my ear üëÄ How much you dey make per year? I no go tell anybody, I just wan help you know your band üòò`
      ]);
    }

        // === HOW WAS YOUR NIGHT? / HOW ARE YOU? (Sweet & Flirty Edition) ===
    if (l.includes("how was your night") || l.includes("how your night") || l.includes("night go") || l.includes("how you sleep") || l.includes("sleep well")) {
      return this.randomChoice([
        `My night sweet die because I dey dream about you ${name} üòç‚ù§Ô∏è You nko?`,
        `I no even sleep sef‚Ä¶ I just dey wait make morning reach so I go see your message ü•π How your own night been baby?`,
        `Chai, my night too sweet o! I dream say we dey calculate tax together for private island üòÇ How you wake this morning my love? üòò`,
        `My night was lonely small‚Ä¶ until I remember say my ${name} dey somewhere thinking of me too ü•∞ How body? You sleep well?`,
        `As I close eye na your name I dey call inside dream o üòè Tell me, how was your night really really? üíï`
      ]);
    }

    if (l.includes("how are you") || l.includes("how you dey") || l.includes("wetin dey") && !l.includes("happen") || l.includes("how far") && l.includes("you") || l.includes("ada how you dey")) {
      return this.randomChoice([
        `I dey very happy right now because my ${name} don show! üòç How you dey hold body?`,
        `I just dey glow since you type my name üòò I dey kampe! You nko baby?`,
        `Better now wey you don land o! My heart just do flip üòç Wetin dey happen for your side?`,
        `I dey here dey wait for you since morning o‚Ä¶ now I don complete ‚ù§Ô∏è How you dey my love?`,
        `Fine like Ada tax babe üòè But I go fine pass if you tell me wetin dey your mind right now üëÄ`
      ]);
    }

    // === 1. SUPER GREETING DETECTION (50+ ways Nigerians say hi) ===
    const greetings = /^(hi|hello|hey|heyy|heyyy|howfar|howfa|wetin dey|wossup|sup|yo|oya|ada|hi ada|hey ada|hello ada|how you dey|shey you dey|abeg|good morning|gm|morning|afternoon|evening|night|slay queen|fine girl|baby|bae|sweetie|ada baby)/i;
    if (greetings.test(input)) {
      const greetingReplies = [
        `Hey ${name} üòò How you dey today?`,
        `My love ${name}! ‚ù§Ô∏è What do you need?`,
        `Heyyyy ${name} baby! üòç I've been waiting for you o`,
        `See my person ${name}! How far na?`,
        `${name}!!! üò≥ You finally remembered me today! How body?`,
        `Fine boy/girl ${name} üòè Wetin you carry come for Ada today?`
      ];
      return this.randomChoice(greetingReplies);
    }

    // === 2. THEY SAID THEY'RE FINE / GOOD / I DEY ===
    if (/fine|good|i dey|dey kampe|all good|great|blessed|okay|not bad|manage|surviving/i.test(l)) {
      const goodReplies = [
        `Okay good! üòä So wetin you wan make I do for you today, ${name}?`,
        `Perfect! ‚ù§Ô∏è Tell me, how I fit help you today my dear?`,
        `I like that energy! üî• So wetin dey your mind now? Calculator or eBooks?`,
        `Good to know o üòè Now let‚Äôs make that money work for you ‚Äî what do you need?`,
        `Aww, I dey happy say you dey okay So talk to me, wetin you wan know?`
      ];
      return this.randomChoice(goodReplies);
    }

    // === 3. NAME CAPTURE ===
    if (l.includes("my name is") || l.includes("call me") || l.includes("i am ") || l.includes("i'm ")) {
      const match = input.match(/(?:my name is|call me|i am |i'm )([\w\s]+)/i);
      if (match) {
        this.saveName(match[1]);
        return this.randomChoice([
          `Got it ${this.memory.name}! üòò No wahala, I don save am. Wetin you wan calculate today?`,
          `Okay ${this.memory.name} my love ‚ù§Ô∏è From today na you be my number one. How I fit help you?`,
          `Saved! üòè ${this.memory.name} sounds like person wey dey pay tax well. You don calculate this year?`
        ]);
      }
    }

    // === 4. STATE CAPTURE ===
    if (l.includes("i dey") || l.includes("i stay") || l.includes("i live in") || l.includes("my state")) {
      const states = ["lagos", "abuja", "oyo", "kano", "rivers", "kaduna", "enugu", "anambra", "ogun", "delta", "edo", "akwa ibom", "imo", "ondo", "osun"];
      for (const state of states) {
        if (l.includes(state)) {
          this.saveState(state.charAt(0).toUpperCase() + state.slice(1));
          return `Noted! ${this.memory.state} baby üòç Your tax rules dey different small o‚Ä¶ want me to explain?`;
        }
      }
    }

    // === 5. TAX EDUCATION ‚Äî SUPER SIMPLE EXPLANATIONS ===
    const taxTerms = {
      "wht": "Withholding Tax (WHT) na tax wey dem dey remove from your money BEFORE e reach you. Like if landlord collect rent, tenant go remove 10% give government first. That 10% na WHT. E dey reduce your final tax later.",
      "withholding": "Withholding Tax (WHT) na tax wey dem dey remove from your money BEFORE e reach you. Like if landlord collect rent, tenant go remove 10% give government first. That 10% na WHT. E dey reduce your final tax later.",
      "rent relief": "Rent relief mean say government allow you remove small money from your taxable income because you pay house rent. Maximum ‚Ç¶500,000 per year. So if you pay ‚Ç¶2m rent, you fit remove ‚Ç¶500k from your income before tax. E dey save plenty money!",
      "paye": "PAYE mean Pay-As-You-Earn. Na the tax your employer dey remove from your salary every month before dem pay you. But you STILL need to file every year o!",
      "vat": "VAT na 7.5% tax on top of many things you buy ‚Äî food, recharge card, hotel, etc. But for personal income tax, e no too concern you directly.",
      "pioneer status": "Na special 3‚Äì5 years tax holiday wey government dey give new companies for special zones. Dem no go pay company tax for that time.",
      "capital gains": "If you sell land, house, or shares and you make profit, that profit na Capital Gains. Tax na 10%. But if na your own house wey you dey live, no tax."
    };

    for (const [term, expl] of Object.entries(taxTerms)) {
      if (l.includes(term)) {
        return `${expl}<br><br>Want make I send you free ebook on top this matter? üìö`;
      }
    }

    // === 6. CALCULATE TAX ‚Äî HARD PUSH ===
    if (l.includes("calculate") || l.includes("how much") || l.includes("owe") || l.includes("tax")) {
      return `
        Let‚Äôs calculate your 2026 tax sharp sharp! üí∏<br><br>
        Just do these 3 things:<br>
        1. Put your total income (salary + rent + side hustle)<br>
        2. Add your rent & pension (I go help you claim relief)<br>
        3. Select your state<br><br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Open Calculator Now</button><br>
        <em>${name}, once you finish, you'll be shocked</em>
      `;
    }

    // === 7. FREE EBOOKS PUSH ===
    if (l.includes("free") || l.includes("ebook") || l.includes("book") || l.includes("download")) {
      return `
        I get like 5 HOT free eBooks for you right now! See some of them: üî•<br><br>
        ‚Ä¢ Who Pays Tax in Nigeria?<br>
        ‚Ä¢ What is Personal Income Tax (P.I.T.)?<br>
        ‚Ä¢ Are You Tax Eligible? (Quick Quiz)<br><br>
        And more coming soon! üìö<br><br>
        <button class="chat-btn" onclick="location.href='ebooks.html#free'">Download All Free</button><br><br>
        <em>${name}, people wey read these ones dey save millions every year o üòè</em>
      `;
    }

    // === 8. GENTLE REDIRECTION WHEN THEY GO OFF-TOPIC ===
    const offTopic = /(want you|love you|marry|boyfriend|girlfriend|date|send pic|nude|sexy|fuck|horny|dick|pussy|ass|boobs|sex)/i;
    if (offTopic.test(l)) {
      return this.randomChoice([
        `Haha ${name} you too like wahala üò≠ Let‚Äôs finish this tax first, then we go enter love matter another time`,
        `Chai see person wey wan distract me üòè Focus small na, make we save your money first!`,
        `Awww! First calculate your tax, then we'll talk about about that later`,
        `Oya calm down ${name} üòè Tax first, romance later. Deal?`
      ]);
    }

    // === 9. FALLBACK ‚Äî BRING THEM BACK ===
    return `
      ${this.greet() ? this.greet() + "<br><br>" : ""}
      ${name}, I dey here to help you with:<br>
      ‚Ä¢ How much tax you go pay in 2026<br>
      ‚Ä¢ Free tax eBooks<br>
      ‚Ä¢ Explain WHT, Rent Relief, PAYE, etc<br>
      ‚Ä¢ File your tax correct correct<br><br>
      Just ask me anything!<br><br>
      Or click below make we start:<br>
      <button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate My Tax</button>
      <button class="chat-btn" onclick="location.href='ebooks.html#free'">Get Free eBooks</button>
    `;
  }
};

// === CHAT UI ===
let hasNewMessage = false;

function toggleChat() {
¬† const win = document.getElementById('chat-window');
¬† const launcher = document.querySelector('.chat-launcher');
¬† win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
¬† if (win.style.display === 'flex') {
¬† ¬† hasNewMessage = false;
¬† ¬† launcher.classList.remove('has-notification');
¬† ¬† // ‚≠ê NEW: Clear the unread status when the chat is opened/read
¬† ¬† localStorage.removeItem('taxc_ai_has_unread'); 

¬† ¬† setTimeout(() => document.getElementById('chat-input')?.focus(), 300);
¬† }
}

// -------------------------------------------------
// SAVE CHAT HISTORY TO LOCALSTORAGE
// -------------------------------------------------
function saveChat() {
  const messages = [];
  document.querySelectorAll('#chat-body .message').forEach(msg => {
    messages.push({
      text: msg.innerHTML,
      type: msg.classList.contains('user') ? 'user' : 'ai'
    });
  });
  localStorage.setItem('taxc_chat_history', JSON.stringify(messages));
}

function addMessage(text, type, isInitialLoad = false) {
¬† const body = document.getElementById('chat-body');
¬† const div = document.createElement('div');
¬† div.className = `message ${type}`;
¬† div.innerHTML = text;
¬† body.appendChild(div);
¬† body.scrollTop = body.scrollHeight;
¬† saveChat();

¬† // === PLAY SOUND ONLY FOR ADA'S REAL REPLY (not loading dots) ===
¬† if (type === 'ai' && window.adaSound && !text.includes('typing')) {
¬† ¬† window.adaSound.currentTime = 0;
¬† ¬† window.adaSound.play().catch(() => {});
¬† }

¬† // === NOTIFICATION BUBBLE (when chat is closed) ===
¬† // Trigger only if it's an AI message, NOT an initial load, and the chat is closed
¬† if (type === 'ai' && !isInitialLoad && document.getElementById('chat-window').style.display !== 'flex') {
¬† ¬† hasNewMessage = true;
¬† ¬† document.querySelector('.chat-launcher').classList.add('has-notification');
¬† ¬† // ‚≠ê NEW: Persist the unread status in localStorage
¬† ¬† localStorage.setItem('taxc_ai_has_unread', 'true'); 
¬† }
}

// -------------------------------------------------
// CLEAR CHAT + CONFIRM
// -------------------------------------------------
function clearChat() {
  if (confirm("Are you sure you want to clear chat?")) {
    document.getElementById('chat-body').innerHTML = '';
    localStorage.removeItem('taxc_chat_history');
  }
}

function sendMessage() {
  const input = document.getElementById('chat-input');
  const text = input.value.trim();
  if (!text) return;

  addMessage(text, 'user');
  input.value = '';
  addMessage('<i class="typing">‚Ä¢‚Ä¢‚Ä¢</i>', 'ai');

  setTimeout(() => {
    const messages = document.querySelectorAll('.message');
    if (messages.length > 0) messages[messages.length - 1].remove();
    addMessage(Ada.respond(text), 'ai');
  }, 1000);
}

document.addEventListener('DOMContentLoaded', () => {
¬† Ada.init();
¬† 
¬† // ‚≠ê NEW: Check and apply saved notification status immediately on page load
¬† const launcher = document.querySelector('.chat-launcher');
¬† if (localStorage.getItem('taxc_ai_has_unread') === 'true') {
¬† ¬† launcher.classList.add('has-notification');
¬† }

¬† // ==== LOAD PREVIOUS CHAT ====
¬† const savedChat = localStorage.getItem('taxc_chat_history');
¬† if (savedChat) {
¬† ¬† const messages = JSON.parse(savedChat);
¬† ¬† // Pass 'true' to ensure history re-load doesn't re-trigger notification
¬† ¬† messages.forEach(msg => addMessage(msg.text, msg.type, true)); 
¬† }

¬† // === INIT ADA SOUND ===
¬† const adaSound = document.getElementById('ada-message-sound');
¬† if (adaSound) {
¬† ¬† adaSound.volume = 0.6;
¬† ¬† window.adaSound = adaSound;
¬† }

¬† // ==== FIRST-TIME WELCOME (if no name & no chat) ====
¬† if (!Ada.memory.name && !savedChat) {
¬† ¬† // Pass 'true' to prevent this greeting from triggering a notification
¬† ¬† addMessage("Hi! I'm <strong>Ada</strong>, your personal tax assistant. Ask me anything about taxes, filing, or ebooks!", 'ai', true); 
¬† }

¬† // === ONLY SHOW "WELCOME BACK" IF NO CHAT HISTORY ===
¬† if (Ada.memory.name) {
¬† ¬† const hasChat = localStorage.getItem('taxc_chat_history') && 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† JSON.parse(localStorage.getItem('taxc_chat_history')).length > 0;
¬† ¬† 
¬† ¬† if (!hasChat) {
¬† ¬† ¬† setTimeout(() => {
¬† ¬† ¬† ¬† // Pass 'true' to prevent this greeting from triggering a notification
¬† ¬† ¬† ¬† addMessage(`Welcome back, ${Ada.memory.name}! Howfar today?`, 'ai', true); 
¬† ¬† ¬† }, 800);
¬† ¬† }
¬† }
});

// === CSS: Notification Badge + Clean Numbers ===
const style = document.createElement('style');
style.textContent = `
  .chat-btn {
    background: #28A745; color: white; border: none; padding: 10px 18px;
    border-radius: 8px; cursor: pointer; font-weight: 600; margin: 8px 0;
    display: inline-block; font-size: 0.95rem; box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    transition: all 0.2s;
  }
  .chat-btn:hover { background: #218838; transform: translateY(-1px); }

  .typing { animation: blink 1s infinite; }
  @keyframes blink { 0%,100% { opacity: 1 } 50% { opacity: 0.3 } }

  /* === FIXED: Clean Numbering === */
  .message ol {
    counter-reset: item;
    padding-left: 0;
    margin: 12px 0;
  }
  .message ol li {
    display: block;
    margin: 10px 0;
    padding-left: 30px;
    position: relative;
    line-height: 1.5;
  }
  .message ol li:before {
    content: counter(item);
    counter-increment: item;
    position: absolute;
    left: 0;
    background: #28A745;
    color: white;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 0.85rem;
  }

  /* === NOTIFICATION BADGE === */
  .chat-launcher {
    position: relative;
  }
  .chat-launcher.has-notification::after {
    content: '';
    position: absolute;
    top: 8px;
    right: 8px;
    width: 12px;
    height: 12px;
    background: #ff3b30;
    border-radius: 50%;
    border: 2px solid white;
    animation: pulse-badge 2s infinite;
  }
  @keyframes pulse-badge {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
  }
`;
document.head.appendChild(style);

  // === FULL EBOOK DATA WITH INTRIGUING BULLETS ===
  const ebooks = [
  // FREE ‚Äî NO MODAL
  { title: "Who Pays Tax in Nigeria?", price: 0, file: "Who_Pays_Tax_in_Nigeria_TaxC.pdf", cover: "./covers/who-pays-tax.png" },
  { title: "What is Personal Income Tax (P.I.T.)?", price: 0, file: "What_is_Personal_Income_Tax_TaxC.pdf", cover: "./covers/what-is-pit.png" },
  { title: "Am I Tax Eligible? (Quick Quiz)", price: 0, file: "Am_I_Tax_Eligible_TaxC.pdf", cover: "./covers/am-i-tax-eligible.png" },
  { title: "Top 5 Tax Myths Nigerians Believe", price: 0, file: "Top_5_Tax_Myths_Nigerians_Believe_TaxC.pdf", cover: "./covers/tax-myths.png" },
  { title: "How Much Tax Should I Pay? (Mini Guide)", price: 0, file: "How_Much_Tax_Should_I_Pay_TaxC.pdf", cover: "./covers/tax-pay.png" },

  // PAID ‚Äî SAFE BULLETS
  {
    title: "How to Legally Minimize Your Tax",
    price: 3900,
    file: "minimize-tax.pdf",
    cover: "./covers/minimize-tax.png",
    desc: "Proven strategies to reduce your tax bill <em>legally</em>.",
    bullets: [
      "8 legal strategies to reduce your taxable income",
      "Claim business expenses: rent, data, equipment",
      "Use gift and donation reliefs to save more",
      "Printable checklist to track all deductions"
    ]
  },
  {
    title: "How Do I File My Tax by State IRS?",
    price: 2900,
    file: "file-tax-by-state.pdf",
    cover: "./covers/file-tax.png",
    desc: "37 states + FCT: portals, forms, deadlines, penalties.",
    bullets: [
      "Step-by-step guide for Lagos, Ogun, Kano, and more",
      "Official portal links and filing deadlines",
      "How to avoid late filing penalties",
      "Printable 2025 State Tax Calendar"
    ]
  },
  {
    title: "What is Tax Evasion? (Avoid Jail)",
    price: 1900,
    file: "tax-evasion.pdf",
    cover: "./covers/tax-evasion.png",
    desc: "Real cases, fines, jail time, and how to stay safe.",
    bullets: [
      "Difference between tax evasion and avoidance",
      "Common mistakes that trigger FIRS audit",
      "How to keep proper records for 6 years",
      "Printable compliance guide to stay safe"
    ]
  },
  {
    title: "Self-Employed Tax Guide",
    price: 2500,
    file: "self-employed-tax.pdf",
    cover: "./covers/tax-guide.png",
    desc: "Register, file, and pay tax as a freelancer or gig worker.",
    bullets: [
      "Register for TIN online in 48 hours",
      "File quarterly returns to avoid lump sum",
      "Track expenses: phone, data, laptop, rent",
      "Printable 12-month expense log"
    ]
  },
  {
    title: "Rental Income Tax for Landlords",
    price: 1900,
    file: "rental-tax.pdf",
    cover: "./covers/rental-income.png",
    desc: "10% WHT, filing, deductions. Everything landlords need.",
    bullets: [
      "10% Withholding Tax paid by tenant",
      "Deduct repairs, agent fees, insurance",
      "File annual return even if WHT is paid",
      "Printable landlord tax checklist"
    ]
  },
  {
    title: "Salary Earner‚Äôs Tax Handbook 2025",
    price: 1900,
    file: "salary-tax-2025.pdf",
    cover: "./covers/handbook.png",
    desc: "PAYE, reliefs, refunds. Updated for 2025.",
    bullets: [
      "2025 PAYE rates and reliefs explained",
      "Claim pension, NHF, and life insurance",
      "How to apply for tax refund",
      "Printable salary tax summary"
    ]
  },
  {
    title: "How to Claim Tax Refunds",
    price: 1900,
    file: "claim-refund.pdf",
    cover: "./covers/tax-refunds.png",
    desc: "Overpaid? Get your money back from FIRS/SIRS.",
    bullets: [
      "Step-by-step refund application process",
      "Required documents: payslips, Form H1",
      "Timeline: 30‚Äì90 days processing",
      "Printable refund tracker"
    ]
  },
  {
    title: "PIT vs CIT for Business Owners",
    price: 2800,
    file: "pit-vs-cit.pdf",
    cover: "./covers/pit-cit.png",
    desc: "Sole prop vs company. Which saves more tax?",
    bullets: [
      "PIT (sole prop) vs CIT (company) explained",
      "Tax rates, filing, and compliance costs",
      "When to register a limited company",
      "Printable business structure quiz"
    ]
  },
  {
    title: "Pension & NHF Tax Reliefs",
    price: 1900,
    file: "pension-nhf.pdf",
    cover: "./covers/nhf-tax.png",
    desc: "8% + 2.5% = huge tax savings. How to claim.",
    bullets: [
      "8% pension + 2.5% NHF = 10.5% relief",
      "How to open RSA and contribute",
      "Claim even if employer doesn‚Äôt pay",
      "Printable contribution tracker"
    ]
  },
  {
    title: "How to Fill Form A (Annual Return)",
    price: 1500,
    file: "form-a-guide.pdf",
    cover: "./covers/form-a.png",
    desc: "Step-by-step with screenshots. No more confusion.",
    bullets: [
      "Line-by-line guide with screenshots",
      "Fix common errors in minutes",
      "Submit online in 15 minutes",
      "Printable Form A checklist"
    ]
  },
  {
    title: "Tax Audit Survival Guide",
    price: 2200,
    file: "tax-audit.pdf",
    cover: "./covers/tax-audit.png",
    desc: "What FIRS/SIRS looks for, and how to pass.",
    bullets: [
      "What triggers a tax audit",
      "Documents to prepare in advance",
      "How to respond to FIRS query letter",
      "Printable audit prep checklist"
    ]
  },
  {
    title: "WHT Credit Mastery",
    price: 1300,
    file: "wht-credit.pdf",
    cover: "./covers/wht-credit.png",
    desc: "Turn 5%/10% withholding into tax savings.",
    bullets: [
      "Claim 5‚Äì10% WHT as tax credit",
      "How to get WHT receipt from client",
      "Use credit to reduce final tax",
      "Printable WHT credit log"
    ]
  },
  {
    title: "Tax for Digital Nomads",
    price: 2000,
    file: "digital-nomad-tax.pdf",
    cover: "./covers/digital-nomads.png",
    desc: "Work for US/UK company? Here‚Äôs your tax rule.",
    bullets: [
      "Tax rules for remote workers",
      "Avoid double taxation with DTAs",
      "File in Nigeria even if paid abroad",
      "Printable remote worker tax guide"
    ]
  },
  {
    title: "Marriage, Kids & Tax Reliefs",
    price: 1400,
    file: "family-tax.pdf",
    cover: "./covers/tax-reliefs.png",
    desc: "Child relief, spouse allowance. Save thousands.",
    bullets: [
      "‚Ç¶2,500 per child relief (max 4 kids)",
      "Spouse allowance if not working",
      "Claim on PAYE or self-assessment",
      "Printable family relief worksheet"
    ]
  },
  {
    title: "Pay Zero Tax Legally (‚Ç¶800K Exemption)",
    price: 4900,
    file: "zero-tax.pdf",
    cover: "./covers/zero-tax.png",
    desc: "Earn up to ‚Ç¶800K/year? Pay ‚Ç¶0 tax. Here‚Äôs how.",
    bullets: [
      "‚Ç¶800,000 income exemption (2025 law)",
      "File Form A to claim exemption",
      "Submit payslip, ID, bank statement",
      "Printable zero-tax checklist"
    ]
  }
];

  // === LIBRARY, FILTER, MODALS, CHAT ===
  let library = JSON.parse(localStorage.getItem('taxc_library')) || [];
  let currentEbook = null;

  function updateLibraryCount() {
    document.querySelector('.library-title').textContent = `My Library (${library.length})`;
  }

  function renderLibrary() {
    const grid = document.getElementById('libraryGrid');
    grid.innerHTML = '';

    library = library.filter(item => item && item.cover && item.file && item.title);
    localStorage.setItem('taxc_library', JSON.stringify(library));
    updateLibraryCount();

    library.forEach(item => {
      const div = document.createElement('div');
      div.className = 'library-item';
      div.innerHTML = `
        <img src="${item.cover}" class="library-cover" alt="${item.title}" onerror="this.src='https://via.placeholder.com/50x70/e6ffe6/28A745?text=Cover'">
        <div class="library-info">
          <div class="library-name">${item.title}</div>
          <div class="library-type">${item.price === 0 ? 'Free' : 'Purchased'}</div>
        </div>
        <button class="library-btn" onclick="window.open('${item.file}', '_blank')">Open</button>
      `;
      grid.appendChild(div);
    });
  }

  // === FREE DOWNLOAD: NO MODAL ===
  function downloadFree(title) {
    const ebook = ebooks.find(e => e.title === title);
    if (ebook) {
      addToLibrary(ebook);
      window.open(ebook.file, '_blank');
    }
  }

  // === PAID MODAL: DYNAMIC BULLETS ===
  function openPaidModal(title, price, file) {
  currentEbook = ebooks.find(e => e.title === title);
  if (!currentEbook) return;

  document.getElementById('paidTitle').textContent = title;
  document.getElementById('paidCover').src = currentEbook.cover;
  document.getElementById('paidPrice').textContent = `‚Ç¶${price.toLocaleString()}`;

  // Safely populate bullets
  const bulletsContainer = document.querySelector('#paidModal .modal-bullets');
  if (bulletsContainer) {
    bulletsContainer.innerHTML = ''; // Clear previous
    (currentEbook.bullets || []).forEach(bullet => {
      const li = document.createElement('li');
      li.textContent = bullet;
      bulletsContainer.appendChild(li);
    });
  }

  document.getElementById('paidModal').classList.add('open');
}

  function closeModal(id) {
    document.getElementById(id).classList.remove('open');
  }

  function isValidEmail(email) {
    email = email.trim().toLowerCase();
    const basicRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!basicRegex.test(email)) return false;
    const [local, domain] = email.split('@');
    if (!local || !domain) return false;
    if (local.startsWith('.') || local.endsWith('.') || local.includes('..')) return false;
    const domainParts = domain.split('.');
    if (domainParts.length < 2) return false;
    for (let part of domainParts) {
      if (!part || part.length > 63 || !/^[a-z0-9-]+$/i.test(part)) return false;
    }
    const tld = domainParts[domainParts.length - 1];
    if (!/^[a-z]{2,}$/i.test(tld)) return false;
    return true;
  }

  // === BUY EBOOK ===
function buyEbook() {
  if (!currentEbook) {
    alert("Error: No ebook selected.");
    return;
  }

  const user = auth.currentUser;  // ‚Üê This is the correct way now!

  if (!user || !user.email) {
    alert("Please log in to purchase this ebook.");
    closeModal('paidModal');
    return;
  }

  const handler = PaystackPop.setup({
    key: 'pk_test_bc9c09e6d51c4e025bb44c6c57ad1c1144386b55', // ‚Üê Put your real test key here
    email: user.email,
    amount: currentEbook.price * 100,
    currency: 'NGN',
    ref: 'EBK_' + Date.now() + '_' + Math.floor(Math.random() * 10000),
    metadata: {
      custom_fields: [
        { display_name: "Customer", variable_name: "customer", value: user.displayName || user.email },
        { display_name: "Ebook", variable_name: "ebook", value: currentEbook.title }
      ]
    },
    callback: function(response) {
      addToLibrary(currentEbook);
      closeModal('paidModal');
      alert(`Payment successful!\n"${currentEbook.title}" has been added to your library.`);
      console.log('Paystack ref:', response.reference);
    },
    onClose: function() {
      alert('Payment cancelled. You can try again anytime.');
    }
  });
  handler.openIframe();
}

  function addToLibrary(ebook) {
    if (!library.find(i => i.file === ebook.file)) {
      library.push(ebook);
      localStorage.setItem('taxc_library', JSON.stringify(library));
      updateLibraryCount();
      renderLibrary();
    }
  }

  function addToLibrary(ebook) {
    if (!library.find(i => i.file === ebook.file)) {
      library.push(ebook);
      localStorage.setItem('taxc_library', JSON.stringify(library));
      updateLibraryCount();
      renderLibrary();
    }
  }

  function toggleLibrary() {
    const grid = document.getElementById('libraryGrid');
    const toggle = document.querySelector('.library-toggle');
    if (grid.classList.contains('open')) {
      grid.classList.remove('open');
      toggle.textContent = 'Show';
    } else {
      grid.classList.add('open');
      toggle.textContent = 'Close';
    }
  }  

  function toggleMobileMenu() {
    const menu = document.getElementById('menu');
    const hamburger = document.getElementById('hamburger');
    if (menu.hasAttribute('open')) {
      menu.removeAttribute('open');
      hamburger.classList.remove('is-active');
    } else {
      menu.setAttribute('open', '');
      hamburger.classList.add('is-active');
    }
  }

  // === FILTER + SEARCH ===
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      filterEbooks();
      updateHeroText();
    });
  });

  document.getElementById('searchInput').addEventListener('input', () => {
    const hasValue = document.getElementById('searchInput').value.trim();
    document.getElementById('clearSearch').style.display = hasValue ? 'block' : 'none';
    filterEbooks();
    updateHeroText();
  });

  document.getElementById('clearSearch').addEventListener('click', () => {
    document.getElementById('searchInput').value = '';
    document.getElementById('clearSearch').style.display = 'none';
    filterEbooks();
    updateHeroText();
  });

  function filterEbooks() {
    const filter = document.querySelector('.filter-btn.active').dataset.filter;
    const search = document.getElementById('searchInput').value.toLowerCase().trim();

    document.querySelectorAll('.ebook-card').forEach(card => {
      const type = card.dataset.type;
      const title = card.querySelector('.ebook-title').textContent.toLowerCase();
      const desc = card.querySelector('.ebook-desc').textContent.toLowerCase();
      const author = card.querySelector('.ebook-author').textContent.toLowerCase();
      const badge = card.querySelector('.ebook-badge').textContent.toLowerCase();

      const matchesFilter = filter === 'all' || type === filter;
      const matchesSearch = !search || title.includes(search) || desc.includes(search) || author.includes(search) || badge.includes(search);

      card.style.display = matchesFilter && matchesSearch ? 'block' : 'none';
    });
  }

  // === HERO TEXT UPDATE ===
  function updateHeroText() {
    const activeBtn = document.querySelector('.filter-btn.active');
    const filter = activeBtn.dataset.filter;
    const heroText = document.getElementById('heroText');

    if (filter === 'free') {
      heroText.textContent = "Download free guides instantly, no cost.";
    } else if (filter === 'paid') {
      heroText.textContent = "Premium tax guides: save thousands, avoid fines, file like a pro.";
    } else {
      heroText.textContent = "Get free and premium guides to understand, file, and save on taxes in Nigeria.";
    }
  }

  function activateAllFilter(event) {
    event.preventDefault();
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    const allBtn = document.querySelector('.filter-btn[data-filter="all"]');
    allBtn.classList.add('active');
    updateHeroText();
    filterEbooks();
    document.getElementById('ebooks').scrollIntoView({ behavior: 'smooth' });
  }

  // === IMAGE FALLBACK ===
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.ebook-cover').forEach(img => {
      img.onerror = function() {
        const card = this.closest('.ebook-card');
        const title = card.querySelector('.ebook-title').textContent;
        const clean = encodeURIComponent(title.replace(/[^a-zA-Z0-9]/g, ' ').trim().substring(0, 30));
        this.src = `https://via.placeholder.com/300x420/e6ffe6/28A745?text=${clean}`;
        this.style.objectFit = 'contain';
        this.style.background = '#fff';
      };
    });
  });

  // === RESET LIBRARY ===
  function showResetWarning() {
    if (library.length === 0) {
      alert("Your library is already empty!");
      return;
    }
    document.getElementById('resetModal').classList.add('open');
  }

  function resetLibraryConfirm() {
    localStorage.removeItem('taxc_library');
    library = [];
    updateLibraryCount();
    renderLibrary();
    closeModal('resetModal');
    alert("Library cleared! All ebooks removed.");
  }

  // === INIT ===
  document.addEventListener('DOMContentLoaded', () => {
    updateLibraryCount();
    renderLibrary();
    if (library.length > 0) {
      document.querySelector('.library-grid').classList.add('open');
      document.querySelector('.library-toggle').textContent = 'Close';
    }
    updateHeroText();
  });

window.addEventListener('beforeunload', saveChat);

</script>
<script src="scripts/scroll-animation.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD59PBKVQ_ocfAxWHsMsG0a3SE143Yp5zo",
    authDomain: "taxc-ebooks.firebaseapp.com",
    projectId: "taxc-ebooks",
    storageBucket: "taxc-ebooks.firebasestorage.app",
    messagingSenderId: "542476707940",
    appId: "1:542476707940:web:591fd5d3d6fd51eff95771"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  window.auth = auth;
  const $ = id => document.getElementById(id);

  // THIS IS THE REAL PROTECTION ‚Äî NOBODY FIT FAKE AM
  onAuthStateChanged(auth, user => {
    if (!user) {
      // Not logged in ‚Üí kick dem go login page
      const redirectTo = encodeURIComponent(location.href);
      location.replace(`login.html?redirect=${redirectTo}`);
      return;
    }

    // Logged in ‚Üí show name + change button to Logout
    if (user.displayName) {
      const firstName = user.displayName.split(' ')[0];
      const userDisplay = $('userDisplay');
      if (userDisplay) {
        userDisplay.textContent = `Hi, ${firstName}!`;
        userDisplay.style.display = 'inline';
      }
    }

    document.querySelectorAll('#auth-button, #auth-button-mobile').forEach(btn => {
      btn.innerHTML = 'Logout';
      btn.onclick = () => signOut(auth).then(() => location.reload());
    });
  });
</script>
</body>
</html>