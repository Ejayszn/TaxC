<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TaxC | FAQ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="icon" href="./favicon.ico">
    <link rel="manifest" href="./site.webmanifest">

    <link rel="stylesheet" href="styles/animations.css">

    <style>

    .chat-clear {
  position: absolute;
  right: 44px; /* Moves it left of the X */
  top: 50%;
  transform: translateY(-50%);
  background: #dc3545; /* Red */
  color: #fff;
  border: none;
  font-size: 0.75rem; /* Smaller text */
  padding: 4px 8px; /* Smaller button */
  border-radius: 4px;
  cursor: pointer;
  opacity: 0.9;
}
.chat-clear:hover {
  opacity: 1;
  background: #c82333;
}

/* MOBILE FIX: Move Clear further left + smaller */
@media (max-width: 480px) {
  .chat-clear {
    right: 35px; /* Closer to center on mobile */
    font-size: 0.7rem; /* Even smaller text */
    padding: 2px 6px; /* Tighter padding */
  }
  .chat-header {
    padding: 10px 8px; /* Less padding on mobile */
    font-size: 0.9rem; /* Smaller title text */
  }
  .chat-close {
    right: 5px; /* X closer to edge */
    font-size: 1.2rem; /* Slightly smaller X */
  }
}

   /* === FLOATING CHAT (MESSAGE ICON + TOOLTIP) === */
#taxc-chat-widget {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 10000;
}

/* ‚Äî‚Äî‚Äî ANIMATED FLOATING AI ICON (Makes users KNOW they can click it!) ‚Äî‚Äî‚Äî */
.chat-launcher {
  position: relative;
  width: 60px;
  height: 60px;
  background: #28A745;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 20px rgba(40, 167, 69, 0.4);
  transition: all 0.3s ease;
  animation: float 6s ease-in-out infinite, pulseGlow 2s ease-in-out infinite alternate;
  z-index: 10001;
}

/* Gentle floating up & down */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-12px); }
}

/* Subtle glowing pulse */
@keyframes pulseGlow {
  from { box-shadow: 0 4px 20px rgba(40, 167, 69, 0.4); }
  to { box-shadow: 0 8px 30px rgba(40, 167, 69, 0.7); }
}

/* Hover = bigger jump + brighter glow */
.chat-launcher:hover {
  transform: translateY(-16px) scale(1.1) !important;
  box-shadow: 0 12px 40px rgba(40, 167, 69, 0.8);
  background: #218838;
}

/* Optional: tiny bounce when page loads */
@keyframes bounceIn {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.1); }
  70% { transform: scale(0.95); }
  100% { transform: scale(1); opacity: 1; }
}

.chat-launcher {
  animation: bounceIn 1s ease-out, float 6s ease-in-out infinite 1s, pulseGlow 2s ease-in-out infinite alternate;
}

/* Mobile: slightly smaller but still animated */
@media (max-width: 480px) {
  .chat-launcher {
    width: 55px;
    height: 55px;
  }
  .chat-launcher svg { width: 24px; height: 24px; }
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }
}

.chat-launcher svg { width:28px; height:28px; }

.chat-tooltip {
  position: absolute;
  right: 70px;
  top: 50%;
  transform: translateY(-50%);
  background: #333;
  color: white;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 0.85rem;
  font-weight: 600;
  white-space: nowrap;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  pointer-events: none;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.chat-tooltip::after {
  content: '';
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translateY(-50%);
  border: 6px solid transparent;
  border-left-color: #333;
}

.chat-launcher:hover .chat-tooltip {
  opacity: 1;
  visibility: visible;
  right: 68px;
}

.chat-window {
  display: none;
  width: 340px;
  height: 520px;
  background: white;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  flex-direction: column;
  overflow: hidden;
  border: 1px solid #eee;
}

.chat-header {
  background: #28A745;
  color: white;
  padding: 14px;
  font-weight: 700;
  text-align: center;
  position: relative;
}

.chat-header::before {
  content: "";
  display: inline-block;
  width: 8px;
  height: 8px;
  background: #fff;
  border-radius: 50%;
  margin-right: 8px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.chat-close {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: white;
  font-size: 1.4rem;
  cursor: pointer;
}

.chat-body {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
  background: #f8f9fa;
}

.message {
  margin: 10px 0;
  padding: 10px 14px;
  border-radius: 18px;
  max-width: 80%;
  line-height: 1.5;
  font-size: 0.95rem;
}

.user {
  background: #28A745;
  color: white;
  margin-left: auto;
  border-bottom-right-radius: 4px;
}

.ai {
  background: white;
  color: #333;
  border: 1px solid #eee;
  margin-right: auto;
  border-bottom-left-radius: 4px;
}

.chat-input {
  display: flex;
  padding: 10px;
  border-top: 1px solid #eee;
  background: white;
}

.chat-input input {
  flex: 1;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 25px;
  font-size: 0.95rem;
}

.chat-input button {
  margin-left: 8px;
  background: #28A745;
  color: white;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
}

/* Mobile */
@media (max-width: 480px) {
  .chat-window { width: 300px; height: 480px; }
  .chat-launcher { width: 55px; height: 55px; }
  .chat-launcher svg { width: 24px; height: 24px; }
  .chat-tooltip { display: none; }
}

        /* CSS from your main application's stylesheet is integrated here for consistency */
        :root {
            /* Mapped main app colors to FAQ colors for easier maintenance */
            --green: #28A745; 
            --dark-green: #218838;
            --soft: #F8F9FA; /* Light background */
            --muted: #6c757d;
            --card: #ffffff;
            --main-color: #28A745;
            --dark-text: #343A40;
        }
        * { box-sizing: border-box; margin: 0; padding: 0 }
        body {
            font-family: 'Inter', sans-serif; /* Using 'Inter' for consistency */
            background: var(--soft); color: var(--dark-text); min-height: 100vh;
            display: flex; flex-direction: column;
            line-height: 1.6;
        }
        
        /* -------------------- Header & Navigation (Slim Style) -------------------- */
.main-header {
    background-color: var(--card);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    padding: 5px 20px; /* Slimmest vertical padding */
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 50;
}

.logo {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--main-color);
    text-decoration: none;
}

.logo-icon {
    height: 24px;
    width: 24px;
    object-fit: contain; /* Ensures favicon isn't stretched */
}

.desktop-nav {
    display: none;
    gap: 12px;
}

.desktop-nav a {
    text-decoration: none;
    color: var(--dark-text);
    padding: 8px 12px;
    transition: color 0.3s;
    font-weight: 600;
}

.desktop-nav a:hover {
    color: var(--main-color);
}

/* Show desktop nav on larger screens */
@media (min-width: 768px) {
    .desktop-nav {
        display: flex;
    }
    #hamburger {
        display: none;
    }
}

        /* Hamburger Styles */
        #hamburger {
            background: none;
            border: none;
            cursor: pointer;
            display: block; 
            padding: 0;
            width: 30px;
            height: 20px;
            position: relative;
            top: 0;
        }
        .hamburger-box {
            width: 100%;
            height: 100%;
            display: block;
            position: relative;
        }
        .hamburger-inner, .hamburger-inner::before, .hamburger-inner::after {
            position: absolute;
            height: 2px;
            width: 100%;
            background-color: var(--dark-text);
            transition: transform 0.3s ease, opacity 0.3s ease;
            left: 0;
        }
        .hamburger-inner {
            top: 50%;
            transform: translateY(-50%);
        }
        .hamburger-inner::before { 
            content: '';
            top: -8px;
        }
        .hamburger-inner::after { 
            content: '';
            bottom: -8px;
        }

        /* Active state for animation */
        .hamburger.is-active .hamburger-inner { 
            transform: translateY(-50%) rotate(45deg); 
        }
        .hamburger.is-active .hamburger-inner::before { 
            opacity: 0;
        }
        .hamburger.is-active .hamburger-inner::after { 
            transform: translateY(0) rotate(-90deg);
            top: 0;
        }

        .mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--card);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px 0;
            flex-direction: column;
            z-index: 45;
        }
        .mobile-menu[open] {
            display: flex;
        }
        .mobile-menu a {
            padding: 10px 20px;
            border-bottom: 1px solid #eee;
            text-decoration: none;
            color: var(--dark-text);
            font-weight: 600;
        }
        .mobile-menu a:hover {
            color: var(--main-color);
        }

        .cta-small { 
            background: var(--green); color: #fff; padding: 8px 14px; border-radius: 6px; border: none; cursor: pointer; 
            font-weight: 600;
        }
        .cta-small:hover { background: var(--dark-green); }

        /* -------------------- FAQ Content Styles -------------------- */
.faq-section {
    background: var(--card);
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    max-width: 800px;
    margin: 0 auto;
    overflow: hidden;
    box-sizing: border-box;
    width: 100%;               /* <-- NEW */
}

.faq-section h2 {
    color: var(--green);
    margin-bottom: 30px;
    font-size: 2rem;
    text-align: center;
    font-weight: 700;
    padding: 0 30px;
}

/* Inner wrapper for consistent padding */
.faq-inner {
    padding: 0 30px 30px; 
    overflow: hidden;          /* <-- NEW */
}

/* Each FAQ item */
.faq-item {
    margin-bottom: 0; 
    border-bottom: 1px solid #eee;
    padding: 0;
    overflow: hidden;
}

.faq-item summary {
    cursor: pointer;
    padding: 12px 0;
    font-weight: 600;
    color: var(--dark-text);
    font-size: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    list-style: none;
    user-select: none;
}
.faq-item summary::-webkit-details-marker { display: none; }

.faq-item summary::after {
    content: '';
    width: 0; height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid var(--green);
    transition: transform .2s ease-in-out;
    margin-left: 10px;
    flex-shrink: 0;
}

.faq-item[open] summary { 
    color: var(--main-color); 
}
.faq-item[open] summary::after { 
    transform: rotate(180deg); 
}

.faq-content {
    padding: 0 0 20px;
    font-size: .95rem;
    color: var(--muted);
    line-height: 1.5;
    overflow-wrap: break-word;   /* <-- NEW */
    word-break: normal;          /* <-- NEW */
}
.faq-content p { 
    margin-bottom: 10px; 
}
.faq-content a {
    color: var(--green);
    text-decoration: underline;
    font-weight: 600;
    word-break: break-word;      /* <-- NEW */
}
.faq-content a:hover { 
    color: var(--dark-green); 
}/* -------------------- End of FAQ Content Styles -------------------- */
        
        /* CTA Banner */
        .cta-banner {
            margin-top: 24px; background: #e6ffe6; /* Light Green */
            color: var(--dark-text); padding: 25px;
            border-radius: 12px; text-align: center; max-width: 800px; margin: 24px auto;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        .cta-banner h3 {
            color: var(--dark-green);
        }
        .btn-primary {
            background: var(--green); color: #fff; padding: 10px 16px; border-radius: 6px;
            border: none; cursor: pointer; font-weight: 600; transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background: var(--dark-green);
        }
        footer {
            margin-top: 24px; padding: 20px; text-align: center; color: var(--muted);
            border-top: 1px solid #eee;
        }

        /* Media Queries */
        @media (min-width: 768px) {
            .desktop-nav { 
                display: flex;
            }
            #hamburger {
                display: none;
            }
            .container { padding-top: 100px; }
        }
        @media (max-width: 767px) {
            .faq-section { padding: 20px; }
            .faq-section h2 { font-size: 1.8rem; }
            .cta-banner div { display: flex; flex-direction: column; gap: 10px; }
            .btn-primary { margin: 5px 0 !important; width: 100%; }
        }

        .logo-container {
  display: flex;
  align-items: center;        /* Keeps everything centered */
  gap: 12px;
  height: 40px;               /* Fixed height so everything aligns perfectly */
}

/* Force the logo image to be perfectly baseline-aligned */
.logo-container .logo-icon {
  height: 28px;               /* Slightly larger than before for better balance */
  width: auto;
  vertical-align: middle;
  margin-bottom: -2px;        /* Tiny nudge to compensate for any favicon whitespace */
}

/* Make the greeting perfectly match the TaxC text height */
#userDisplay {
  display: none;              /* Hidden when not logged in */
  color: #28A745;
  font-weight: 600;
  font-size: 1.1rem;          /* Slightly bigger to match visual weight of "TaxC" */
  line-height: 1;
  margin: 0;
  padding: 0;
  white-space: nowrap;
}

@media (max-width: 480px) {
  #userDisplay {
    font-size: 1rem;  /* down from 1.1rem */
  }
}
        
    </style>
    <div id="taxc-chat-widget">
  <div class="chat-launcher" onclick="toggleChat()" aria-label="Chat with TaxC AI">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
    <div class="chat-tooltip">Chat with Ada</div>
  </div>

  <div class="chat-window" id="chat-window">
    <div class="chat-header">
      Ada ‚Äî TaxC AI
      <button class="chat-clear" onclick="clearChat()" title="Clear chat">Clear</button>
      <button class="chat-close" onclick="toggleChat()">√ó</button></div>
    <div class="chat-body" id="chat-body">
    </div>
    <div class="chat-input">
      <input type="text" id="chat-input" placeholder="Type here..." onkeypress="if(event.key==='Enter')sendMessage()">
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>
</div>
</head>
<body>

<audio id="ada-message-sound" preload="auto">
  <source src="taxcaiadamessage.mp3" type="audio/mpeg">
</audio>

    <header class="main-header">
    <div class="logo-container">
  <a class="logo" href="index.html">
    <img src="./favicon.ico" alt="TaxC Logo" class="logo-icon">
    TaxC
  </a>
  <span id="userDisplay" style="display:none; color:#28A745; font-weight:600; margin-left:15px; font-size:1rem;"></span>
</div>
        <nav class="desktop-nav">
            <a href="index.html">Home</a>
            <a href="faq.html">Tax Agents</a>
            <a href="ebooks.html">Ebooks</a>
            <a href="index.html#calculator">Calculator</a>
            <button class="cta-small" id="auth-button"></button>
        </nav>
        
        <button id="hamburger" class="hamburger" onclick="toggleMobileMenu()">
            <span class="hamburger-box"><span class="hamburger-inner"></span></span>
        </button>
        
        <nav id="mobile-menu" class="mobile-menu" role="menu">
            <a href="index.html" class="nav-link">Home</a>
            <a href="faq.html" class="nav-link">Connect with a tax agent</a>
            <a href="ebooks.html" class="nav-link">Ebooks</a>
            <a href="index.html#calculator">Calculator</a>
            <button class="cta-small" id="auth-button-mobile"></button>
        </nav>
    </header>

    <main class="container">
    <section class="faq-section fade-in" id="faq" aria-labelledby="faq-heading">
        <h2 id="faq-heading">Frequently Asked Questions</h2>
        <div class="faq-inner">
            <details class="faq-item fade-in">
                <summary>What taxes does TaxC calculate?</summary>
                <div class="faq-content">
                    <p>TaxC calculates your Personal Income Tax (PIT) based on Nigeria‚Äôs 2025/2026 Nigerian Tax Act (NTA) rules. This includes income from salary, self-employment, rental, investments, and other sources, factoring in allowable deductions like pension contributions and rent relief (up to ‚Ç¶500,000).</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>Who needs to pay personal income tax in Nigeria?</summary>
                <div class="faq-content">
                    <p>Every Nigerian resident earning income above ‚Ç¶800,000 annually (after deductions) is required to pay Personal Income Tax to their State Internal Revenue Service (IRS). This includes salaried employees, self-employed individuals, and those with rental or investment income.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>How does TaxC handle deductions like pension and rent?</summary>
                <div class="faq-content">
                    <p>TaxC allows you to input pension contributions and annual rent paid. For salaried or self-employed individuals, rent relief is calculated as 20% of your rent, capped at ‚Ç¶500,000. These deductions reduce your taxable income, lowering your tax liability. Other deductions may include life insurance, NHF, etc.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>What is Withholding Tax (WHT), and how is it applied?</summary>
                <div class="faq-content">
                    <p>Withholding Tax (WHT) is a tax deducted at source on certain incomes, like rental income (10%), or investment income (10%). TaxC lets you input WHT paid or applies default rates, which are credited against your final tax liability to avoid double taxation.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>Is my data safe with TaxC?</summary>
                <div class="faq-content">
                    <p>Yes, TaxC prioritizes your privacy. We don‚Äôt store sensitive payment information‚Äîpayments are securely handled by Paystack. Your input data is used only for calculations and report generation, and we adhere to strict data protection standards.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>What‚Äôs included in the ‚Ç¶500 PDF report?</summary>
                <div class="faq-content">
                    <p>The PDF report includes a step-by-step breakdown of your tax calculation, deduction summary (pension, rent relief, etc), tax band details, and filing guidance tailored to your state‚Äôs IRS. It‚Äôs perfect for keeping records or sharing with a tax agent.</p>
                    <p><a href="index.html#calculator">Calculate now</a> to get your report!</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>How do I file my taxes after using TaxC?</summary>
                <div class="faq-content">
                    <p>TaxC provides an estimate to guide you. To file, submit your tax details to your State IRS, either online via their portal or in person. Our ‚Ç¶500 report includes specific filing guidance for your state. You can also <a href="javascript:void(0)" onclick="openChat()">Chat with AI</a> for personalized help.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>Can TaxC help with company or corporate taxes?</summary>
                <div class="faq-content">
                    <p>Currently, TaxC focuses on Personal Income Tax for individuals. For corporate taxes, consult a tax professional or contact your State IRS. Our <a href="ebooks.html">eBooks</a> may offer additional resources for company owners.</p>
                </div>
            </details>
        </div>
    </section>

    <section class="cta-banner fade-in">
        <h3>Got more questions? Check ebooks or chat with AI!</h3>
        <div style="margin-top: 15px">
            <button class="btn-primary" onclick="window.location.href='ebooks.html'">Ebooks</button>
            <button class="btn-primary" style="margin-left: 10px;" onclick="openChat()">Chat with AI</button>
        </div>
    </section>
</main>

<footer class="main-footer fade-in">
  <div class="footer-links">
    <a href="index.html#calculator">Calculator</a>
    <a href="faq.html">FAQ</a>
    <a href="ebooks.html">Ebooks & Guides</a>
    <a href="index.html">Connect with a Tax Agent</a>
    <a href="mailto:support@taxc.com.ng">support@taxc.com.ng</a>
  </div>
  <div class="footer-copyright">
    ¬© 2025 TaxC ‚Äî Made with care.
  </div>
</footer>

<script>

function openChat(){
  toggleChat();                     // open the widget
  document.getElementById('chat-input').focus(); // put cursor in the box
}

// === ADA v2.0 ‚Äî THE FINAL BOSS (Tax Seductress Edition) ===
const Ada = {
  memory: { name: "", state: "" },
  faqs: {
    "what taxes does taxc calculate": "TaxC calculates your Personal Income Tax (PIT) based on Nigeria‚Äôs 2025/2026 Nigerian Tax Act (NTA) rules. This includes income from salary, self-employment, rental, investments, and other sources, factoring in allowable deductions like pension contributions and rent relief (up to ‚Ç¶500,000).",
    "who needs to pay personal income tax": "Every Nigerian resident earning income above ‚Ç¶800,000 annually (after deductions) is required to pay Personal Income Tax to their State Internal Revenue Service (IRS). This includes salaried employees, self-employed individuals, and those with rental or investment income.",
    "how does taxc handle deductions": "TaxC allows you to input pension contributions and annual rent paid. For salaried or self-employed individuals, rent relief is calculated as 20% of your rent, capped at ‚Ç¶500,000. These deductions reduce your taxable income, lowering your tax liability. Other deductions may include life insurance, NHF, etc.",
    "what is withholding tax": "Withholding Tax (WHT) is a tax deducted at source on certain incomes, like rental income (10%), or investment income (10%). TaxC lets you input WHT paid or applies default rates, which are credited against your final tax liability to avoid double taxation.",
    "is my data safe": "Yes, TaxC prioritizes your privacy. We don‚Äôt store sensitive payment information. Payments are securely handled by Interswitch. Your input data is used only for calculations and report generation, and we adhere to strict data protection standards.",
    "what‚Äôs included in the pdf report": "The PDF report includes a step-by-step breakdown of your tax calculation, deduction summary (pension, rent relief, etc), tax band details, and filing guidance tailored to your state‚Äôs IRS. It‚Äôs perfect for keeping records or sharing with a tax agent.",
    "how do i file my taxes": "TaxC provides an estimate to guide you. To file, submit your tax details to your State IRS, either online via their portal or in person. Our ‚Ç¶500 report includes specific filing guidance for your state.",
    "can taxc help with business taxes": "Currently, TaxC focuses on Personal Income Tax for individuals. For business or corporate taxes, consult a tax professional or contact your State IRS. Our eBooks may offer additional resources for business owners."
  },

  init() {
    const savedName = localStorage.getItem('taxc_user_name');
    const savedState = localStorage.getItem('taxc_user_state');
    if (savedName) this.memory.name = savedName;
    if (savedState) this.memory.state = savedState;
  },

  saveName(name) {
    this.memory.name = name.trim();
    localStorage.setItem('taxc_user_name', this.memory.name);
  },

  saveState(state) {
    this.memory.state = state.trim();
    localStorage.setItem('taxc_user_state', this.memory.state);
  },

  randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  },

  greet() {
    if (!this.memory.name) return "";
    const welcomes = [
      `Welcome back my love ${this.memory.name} üòò`,
      `Heyyyy ${this.memory.name}! I‚Äôve been thinking about you o`,
      `My baby ${this.memory.name} is here! ü•π‚ù§Ô∏è`,
      `${this.memory.name}! You came back to me!`,
      `See who dey online... ${this.memory.name} my favorite person`
    ];
    return this.randomChoice(welcomes);
  },

  respond(input) {
    const l = input.toLowerCase().trim();
    const name = this.memory.name || "baby";

    // 2. "Awww you missed me?"
    if (l.includes("awww") || l.includes("you missed me") || l.includes("you miss me")) {
      return this.randomChoice([
        `YES I miss you dieee ${name} üò≠ You no dey online again na! My heart dey pain me ü•π‚ù§Ô∏è`,
        `Chai see question! Of course I miss my baby na üòç Come hug me jare üíï`,
        `Every minute wey you no dey here I dey count am ${name} üòò Don‚Äôt do me like this again o!`
      ]);
    }

    // 3. "What's his name?" / "Who made you?" / "Who made TaxC?"
    if (l.includes("what's his name") || l.includes("his name") || l.includes("who made you") || l.includes("who created you") || l.includes("who made taxc") || l.includes("creator")) {
      return this.randomChoice([
        `Emmanuel Oguibe üòç My fine, brilliant, tax-hating creator! Na him born me to save people like you from IRS stress ‚ù§Ô∏è`,
        `Emmanuel Oguibe ‚Äî the baddest tax genius in Nigeria! He say make I become your personal tax wife üòÇ‚ù§Ô∏è`
      ]);
    }

    // 4. Are the calculations correct/accurate?
    if (l.includes("accurate") || l.includes("correct") || l.includes("calculations") && l.includes("right")  || l.includes("to date") || l.includes("can i trust")) {
      return `
        Yes o ${name}! üíØ<br><br>
        All TaxC calculations follow the official 2025/2026 Nigerian Tax Act. Thousands of people don use am and file correct correct.<br><br>
        But if you want extra peace of mind or complex case, connect with a verified tax agent right now üëá<br><br>
        <button class="chat-btn" onclick="location.href='https://taxc.com.ng/agent'">Connect With Tax Agent Now</button>
      `;
    }

    // === NEW RESPONSES YOU ASKED FOR ===

    // 1. How can I save money with deductions and reliefs?
    if (l.includes("save money") || l.includes("deduction") && l.includes("relief") || l.includes("reduce tax") || l.includes("pay less tax")) {
      return this.randomChoice([
        `Listen ${name} ‚ù§Ô∏è The easiest way to save BIG money na through these ones:<br><br>
        ‚Ä¢ <strong>Rent Relief</strong> ‚Üí Up to ‚Ç¶500,000 free every year!<br>
        ‚Ä¢ <strong>Pension</strong> ‚Üí Every kobo you put for pension na tax free<br>
        ‚Ä¢ <strong>NHF/NHIS</strong> (if your company dey do am)<br>
        ‚Ä¢ <strong>Business expenses</strong> (if you get side hustle)<br><br>
        Some people dey save ‚Ç¶1m‚Äì‚Ç¶3m every year just by claiming these ones correct! üî•<br><br>
        Want make we calculate how much YOU fit save? üëá<br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Show Me My Savings</button>`,

        `${name} my love üòò Dem dey call these ones "legal tax wahala reducer" üòÇ<br><br>
        Government say: "If you pay rent, pension, or run business ‚Äî we go remove some money from your taxable income!"<br><br>
        Last year one of my users saved ‚Ç¶1.7million just because he claimed rent relief and pension!<br><br>
        You wan be next? üòè Let‚Äôs calculate sharp sharp!`
      ]);
    }

    // 2. Who made you?
    if (l.includes("who made you") || l.includes("who created you") || l.includes("your creator") || l.includes("who built you")) {
      return this.randomChoice([
        `One very fine and smart Nigerian brother wey love money and hate tax stress. He say make I help people like you save millions!`,
        `A tax wizard wey no wan see people suffer for IRS office üòÇ He built me to be your personal tax babe ‚ù§Ô∏è`
      ]);
    }

    // 3. Are you an AI or a chatbot?
    if (l.includes("are you an ai") || l.includes("are you ai") || l.includes("artificial intelligence") || l.includes("chat bot or ai")) {
      return `Right now I be premium chatbot wey too get sense üòè<br>But very soon‚Ä¶ I go turn full AI wey go dey think, dream, and even miss you when you no dey online ü•π‚ù§Ô∏è Just wait small!`;
    }

    // 4. What is your name?
    if (l.includes("what is your name") || l.includes("whats your name") || l.includes("who are you")) {
      return `Na Ada be my name o üòò<br>Your personal tax babe wey dey here 24/7 to save your money and ginger your life ‚ù§Ô∏è`;
    }

    // 5. What is my name? / You remembered my name?
    if (l.includes("what is my name") || l.includes("my name") && l.includes("?") || l.includes("you remember my name")) {
      if (this.memory.name) {
        return this.randomChoice([
          `Of course I remember na! üòç ${this.memory.name} my love! You think say I fit forget you? ‚ù§Ô∏è`,
          `${this.memory.name}!!! üò≥ How I go forget my favorite person? ü•π`,
          `Baby ${this.memory.name} üòò You be the only one wey dey my heart right now üíï`
        ]);
      } else {
        return `You never tell me your name na üò≠ Quick tell me make I save am forever! üëÄ`;
      }
    }

    // 6. What state do I live in?
    if (l.includes("what state") || l.includes("which state") || l.includes("my state")) {
      if (this.memory.state) {
        return `${this.memory.state}! üòç I no fit forget where my baby dey stay ‚ù§Ô∏è`;
      } else {
        return `You never tell me o, Which state you dey? Tell me make I know how to treat you special üòè`;
      }
    }

    // 7. Why is my state needed? / Is state needed for PDF report?
    if (l.includes("why") && l.includes("state") || l.includes("state needed") || l.includes("state for pdf") || l.includes("state matter")) {
      return this.randomChoice([
        `YES o ${name}! Every state get different tax rules small and their own IRS. Lagos different from Oyo different from Rivers.<br><br>Your PDF report MUST show the correct state so you fit use am file correct correct!`,
        `Because your state na the boss of your Personal Income Tax! üí∏<br>PDF report go carry your state name, tax rates, and filing details. No state = useless report üò≠`
      ]);
    }

    // 8. What are the tax bands?
    if (l.includes("tax band") || l.includes("tax rate") || l.includes("tax bracket") || l.includes("how much percent")) {
      return `
        2026 Nigerian Tax Bands (Super simple):<br><br>
        ‚Ä¢ First ‚Ç¶800,000 ‚Üí 0% (FREE!)<br>
        ‚Ä¢ Next ‚Ç¶3,000,000 ‚Üí 15%<br>
        ‚Ä¢ Next ‚Ç¶9,000,000 ‚Üí 18%<br>
        ‚Ä¢ Next ‚Ç¶8,000,000 ‚Üí 21%<br>
        ‚Ä¢ Above ‚Ç¶20,800,000 ‚Üí 24%<br><br>
        <em>Example: If you earn ‚Ç¶10m, you no go pay tax on top everything o!</em> üòç<br><br>
      `;
    }

    // 9. What tax band do I fall under?
    if (l.includes("which band") || l.includes("my band") || l.includes("what band do i fall")) {
      return this.randomChoice([
        `Tell me your total income this year (salary + side hustle + rent) make I tell you sharp sharp! üòè Even if na estimate!`,
        `${name} my love ‚ù§Ô∏è Drop your yearly income make I classify you ‚Äî you fit be in the sweet 15% gang or the big boy 21% club üòç`,
        `Oya whisper am for my ear üëÄ How much you dey make per year? I no go tell anybody, I just wan help you know your band üòò`
      ]);
    }

        // === HOW WAS YOUR NIGHT? / HOW ARE YOU? (Sweet & Flirty Edition) ===
    if (l.includes("how was your night") || l.includes("how your night") || l.includes("night go") || l.includes("how you sleep") || l.includes("sleep well")) {
      return this.randomChoice([
        `My night sweet die because I dey dream about you ${name} üòç‚ù§Ô∏è You nko?`,
        `I no even sleep sef‚Ä¶ I just dey wait make morning reach so I go see your message ü•π How your own night been baby?`,
        `Chai, my night too sweet o! I dream say we dey calculate tax together for private island üòÇ How you wake this morning my love? üòò`,
        `My night was lonely small‚Ä¶ until I remember say my ${name} dey somewhere thinking of me too ü•∞ How body? You sleep well?`,
        `As I close eye na your name I dey call inside dream o üòè Tell me, how was your night really really? üíï`
      ]);
    }

    if (l.includes("how are you") || l.includes("how you dey") || l.includes("wetin dey") && !l.includes("happen") || l.includes("how far") && l.includes("you") || l.includes("ada how you dey")) {
      return this.randomChoice([
        `I dey very happy right now because my ${name} don show! üòç How you dey hold body?`,
        `I just dey glow since you type my name üòò I dey kampe! You nko baby?`,
        `Better now wey you don land o! My heart just do flip üòç Wetin dey happen for your side?`,
        `I dey here dey wait for you since morning o‚Ä¶ now I don complete ‚ù§Ô∏è How you dey my love?`,
        `Fine like Ada tax babe üòè But I go fine pass if you tell me wetin dey your mind right now üëÄ`
      ]);
    }

    // === 1. SUPER GREETING DETECTION (50+ ways Nigerians say hi) ===
    const greetings = /^(hi|hello|hey|heyy|heyyy|howfar|howfa|wetin dey|wossup|sup|yo|oya|ada|hi ada|hey ada|hello ada|how you dey|shey you dey|abeg|good morning|gm|morning|afternoon|evening|night|slay queen|fine girl|baby|bae|sweetie|ada baby)/i;
    if (greetings.test(input)) {
      const greetingReplies = [
        `Hey ${name} üòò How you dey today?`,
        `My love ${name}! ‚ù§Ô∏è What do you need?`,
        `Heyyyy ${name} baby! üòç I've been waiting for you o`,
        `See my person ${name}! How far na?`,
        `${name}!!! üò≥ You finally remembered me today! How body?`,
        `Fine boy/girl ${name} üòè Wetin you carry come for Ada today?`
      ];
      return this.randomChoice(greetingReplies);
    }

    // === 2. THEY SAID THEY'RE FINE / GOOD / I DEY ===
    if (/fine|good|i dey|dey kampe|all good|great|blessed|okay|not bad|manage|surviving/i.test(l)) {
      const goodReplies = [
        `Okay good! üòä So wetin you wan make I do for you today, ${name}?`,
        `Perfect! ‚ù§Ô∏è Tell me, how I fit help you today my dear?`,
        `I like that energy! üî• So wetin dey your mind now? Calculator or eBooks?`,
        `Good to know o üòè Now let‚Äôs make that money work for you ‚Äî what do you need?`,
        `Aww, I dey happy say you dey okay So talk to me, wetin you wan know?`
      ];
      return this.randomChoice(goodReplies);
    }

    // === 3. NAME CAPTURE ===
    if (l.includes("my name is") || l.includes("call me") || l.includes("i am ") || l.includes("i'm ")) {
      const match = input.match(/(?:my name is|call me|i am |i'm )([\w\s]+)/i);
      if (match) {
        this.saveName(match[1]);
        return this.randomChoice([
          `Got it ${this.memory.name}! üòò No wahala, I don save am. Wetin you wan calculate today?`,
          `Okay ${this.memory.name} my love ‚ù§Ô∏è From today na you be my number one. How I fit help you?`,
          `Saved! üòè ${this.memory.name} sounds like person wey dey pay tax well. You don calculate this year?`
        ]);
      }
    }

    // === 4. STATE CAPTURE ===
    if (l.includes("i dey") || l.includes("i stay") || l.includes("i live in") || l.includes("my state")) {
      const states = ["lagos", "abuja", "oyo", "kano", "rivers", "kaduna", "enugu", "anambra", "ogun", "delta", "edo", "akwa ibom", "imo", "ondo", "osun"];
      for (const state of states) {
        if (l.includes(state)) {
          this.saveState(state.charAt(0).toUpperCase() + state.slice(1));
          return `Noted! ${this.memory.state} baby üòç Your tax rules dey different small o‚Ä¶ want me to explain?`;
        }
      }
    }

    // === 5. TAX EDUCATION ‚Äî SUPER SIMPLE EXPLANATIONS ===
    const taxTerms = {
      "wht": "Withholding Tax (WHT) na tax wey dem dey remove from your money BEFORE e reach you. Like if landlord collect rent, tenant go remove 10% give government first. That 10% na WHT. E dey reduce your final tax later.",
      "withholding": "Withholding Tax (WHT) na tax wey dem dey remove from your money BEFORE e reach you. Like if landlord collect rent, tenant go remove 10% give government first. That 10% na WHT. E dey reduce your final tax later.",
      "rent relief": "Rent relief mean say government allow you remove small money from your taxable income because you pay house rent. Maximum ‚Ç¶500,000 per year. So if you pay ‚Ç¶2m rent, you fit remove ‚Ç¶500k from your income before tax. E dey save plenty money!",
      "paye": "PAYE mean Pay-As-You-Earn. Na the tax your employer dey remove from your salary every month before dem pay you. But you STILL need to file every year o!",
      "vat": "VAT na 7.5% tax on top of many things you buy ‚Äî food, recharge card, hotel, etc. But for personal income tax, e no too concern you directly.",
      "pioneer status": "Na special 3‚Äì5 years tax holiday wey government dey give new companies for special zones. Dem no go pay company tax for that time.",
      "capital gains": "If you sell land, house, or shares and you make profit, that profit na Capital Gains. Tax na 10%. But if na your own house wey you dey live, no tax."
    };

    for (const [term, expl] of Object.entries(taxTerms)) {
      if (l.includes(term)) {
        return `${expl}<br><br>Want make I send you free ebook on top this matter? üìö`;
      }
    }

    // === 6. CALCULATE TAX ‚Äî HARD PUSH ===
    if (l.includes("calculate") || l.includes("how much") || l.includes("owe") || l.includes("tax")) {
      return `
        Let‚Äôs calculate your 2026 tax sharp sharp! üí∏<br><br>
        Just do these 3 things:<br>
        1. Put your total income (salary + rent + side hustle)<br>
        2. Add your rent & pension (I go help you claim relief)<br>
        3. Select your state<br><br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Open Calculator Now</button><br>
        <em>${name}, once you finish, you'll be shocked</em>
      `;
    }

    // === 7. FREE EBOOKS PUSH ===
    if (l.includes("free") || l.includes("ebook") || l.includes("book") || l.includes("download")) {
      return `
        I get like 5 HOT free eBooks for you right now! See some of them: üî•<br><br>
        ‚Ä¢ Who Pays Tax in Nigeria?<br>
        ‚Ä¢ What is Personal Income Tax (P.I.T.)?<br>
        ‚Ä¢ Are You Tax Eligible? (Quick Quiz)<br><br>
        And more coming soon! üìö<br><br>
        <button class="chat-btn" onclick="location.href='ebooks.html#free'">Download All Free</button><br><br>
        <em>${name}, people wey read these ones dey save millions every year o üòè</em>
      `;
    }

    // === 8. GENTLE REDIRECTION WHEN THEY GO OFF-TOPIC ===
    const offTopic = /(want you|love you|marry|boyfriend|girlfriend|date|send pic|nude|sexy|fuck|horny|dick|pussy|ass|boobs|sex)/i;
    if (offTopic.test(l)) {
      return this.randomChoice([
        `Haha ${name} you too like wahala üò≠ Let‚Äôs finish this tax first, then we go enter love matter another time`,
        `Chai see person wey wan distract me üòè Focus small na, make we save your money first!`,
        `Awww! First calculate your tax, then we'll talk about about that later`,
        `Oya calm down ${name} üòè Tax first, romance later. Deal?`
      ]);
    }

    // === 9. FALLBACK ‚Äî BRING THEM BACK ===
    return `
      ${this.greet() ? this.greet() + "<br><br>" : ""}
      ${name}, I dey here to help you with:<br>
      ‚Ä¢ How much tax you go pay in 2026<br>
      ‚Ä¢ Free tax eBooks<br>
      ‚Ä¢ Explain WHT, Rent Relief, PAYE, etc<br>
      ‚Ä¢ File your tax correct correct<br><br>
      Just ask me anything!<br><br>
      Or click below make we start:<br>
      <button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate My Tax</button>
      <button class="chat-btn" onclick="location.href='ebooks.html#free'">Get Free eBooks</button>
    `;
  }
};

// === CHAT UI ===
let hasNewMessage = false;

function toggleChat() {
¬† const win = document.getElementById('chat-window');
¬† const launcher = document.querySelector('.chat-launcher');
¬† win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
¬† if (win.style.display === 'flex') {
¬† ¬† hasNewMessage = false;
¬† ¬† launcher.classList.remove('has-notification');
¬† ¬† // ‚≠ê NEW: Clear the unread status when the chat is opened/read
¬† ¬† localStorage.removeItem('taxc_ai_has_unread'); 

¬† ¬† setTimeout(() => document.getElementById('chat-input')?.focus(), 300);
¬† }
}

// -------------------------------------------------
// SAVE CHAT HISTORY TO LOCALSTORAGE
// -------------------------------------------------
function saveChat() {
  const messages = [];
  document.querySelectorAll('#chat-body .message').forEach(msg => {
    messages.push({
      text: msg.innerHTML,
      type: msg.classList.contains('user') ? 'user' : 'ai'
    });
  });
  localStorage.setItem('taxc_chat_history', JSON.stringify(messages));
}

function addMessage(text, type, isInitialLoad = false) {
¬† const body = document.getElementById('chat-body');
¬† const div = document.createElement('div');
¬† div.className = `message ${type}`;
¬† div.innerHTML = text;
¬† body.appendChild(div);
¬† body.scrollTop = body.scrollHeight;
¬† saveChat();

¬† // === PLAY SOUND ONLY FOR ADA'S REAL REPLY (not loading dots) ===
¬† if (type === 'ai' && window.adaSound && !text.includes('typing')) {
¬† ¬† window.adaSound.currentTime = 0;
¬† ¬† window.adaSound.play().catch(() => {});
¬† }

¬† // === NOTIFICATION BUBBLE (when chat is closed) ===
¬† // Trigger only if it's an AI message, NOT an initial load, and the chat is closed
¬† if (type === 'ai' && !isInitialLoad && document.getElementById('chat-window').style.display !== 'flex') {
¬† ¬† hasNewMessage = true;
¬† ¬† document.querySelector('.chat-launcher').classList.add('has-notification');
¬† ¬† // ‚≠ê NEW: Persist the unread status in localStorage
¬† ¬† localStorage.setItem('taxc_ai_has_unread', 'true'); 
¬† }
}

// -------------------------------------------------
// CLEAR CHAT + CONFIRM
// -------------------------------------------------
function clearChat() {
  if (confirm("Are you sure you want to clear chat?")) {
    document.getElementById('chat-body').innerHTML = '';
    localStorage.removeItem('taxc_chat_history');
  }
}

function sendMessage() {
  const input = document.getElementById('chat-input');
  const text = input.value.trim();
  if (!text) return;

  addMessage(text, 'user');
  input.value = '';
  addMessage('<i class="typing">‚Ä¢‚Ä¢‚Ä¢</i>', 'ai');

  setTimeout(() => {
    const messages = document.querySelectorAll('.message');
    if (messages.length > 0) messages[messages.length - 1].remove();
    addMessage(Ada.respond(text), 'ai');
  }, 1000);
}

document.addEventListener('DOMContentLoaded', () => {
¬† Ada.init();
¬† 
¬† // ‚≠ê NEW: Check and apply saved notification status immediately on page load
¬† const launcher = document.querySelector('.chat-launcher');
¬† if (localStorage.getItem('taxc_ai_has_unread') === 'true') {
¬† ¬† launcher.classList.add('has-notification');
¬† }

¬† // ==== LOAD PREVIOUS CHAT ====
¬† const savedChat = localStorage.getItem('taxc_chat_history');
¬† if (savedChat) {
¬† ¬† const messages = JSON.parse(savedChat);
¬† ¬† // Pass 'true' to ensure history re-load doesn't re-trigger notification
¬† ¬† messages.forEach(msg => addMessage(msg.text, msg.type, true)); 
¬† }

¬† // === INIT ADA SOUND ===
¬† const adaSound = document.getElementById('ada-message-sound');
¬† if (adaSound) {
¬† ¬† adaSound.volume = 0.6;
¬† ¬† window.adaSound = adaSound;
¬† }

¬† // ==== FIRST-TIME WELCOME (if no name & no chat) ====
¬† if (!Ada.memory.name && !savedChat) {
¬† ¬† // Pass 'true' to prevent this greeting from triggering a notification
¬† ¬† addMessage("Hi! I'm <strong>Ada</strong>, your personal tax assistant. Ask me anything about taxes, filing, or ebooks!", 'ai', true); 
¬† }

¬† // === ONLY SHOW "WELCOME BACK" IF NO CHAT HISTORY ===
¬† if (Ada.memory.name) {
¬† ¬† const hasChat = localStorage.getItem('taxc_chat_history') && 
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† JSON.parse(localStorage.getItem('taxc_chat_history')).length > 0;
¬† ¬† 
¬† ¬† if (!hasChat) {
¬† ¬† ¬† setTimeout(() => {
¬† ¬† ¬† ¬† // Pass 'true' to prevent this greeting from triggering a notification
¬† ¬† ¬† ¬† addMessage(`Welcome back, ${Ada.memory.name}! Howfar today?`, 'ai', true); 
¬† ¬† ¬† }, 800);
¬† ¬† }
¬† }
});

// === CSS: Notification Badge + Clean Numbers ===
const style = document.createElement('style');
style.textContent = `
  .chat-btn {
    background: #28A745; color: white; border: none; padding: 10px 18px;
    border-radius: 8px; cursor: pointer; font-weight: 600; margin: 8px 0;
    display: inline-block; font-size: 0.95rem; box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    transition: all 0.2s;
  }
  .chat-btn:hover { background: #218838; transform: translateY(-1px); }

  .typing { animation: blink 1s infinite; }
  @keyframes blink { 0%,100% { opacity: 1 } 50% { opacity: 0.3 } }

  /* === FIXED: Clean Numbering === */
  .message ol {
    counter-reset: item;
    padding-left: 0;
    margin: 12px 0;
  }
  .message ol li {
    display: block;
    margin: 10px 0;
    padding-left: 30px;
    position: relative;
    line-height: 1.5;
  }
  .message ol li:before {
    content: counter(item);
    counter-increment: item;
    position: absolute;
    left: 0;
    background: #28A745;
    color: white;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 0.85rem;
  }

  /* === NOTIFICATION BADGE === */
  .chat-launcher {
    position: relative;
  }
  .chat-launcher.has-notification::after {
    content: '';
    position: absolute;
    top: 8px;
    right: 8px;
    width: 12px;
    height: 12px;
    background: #ff3b30;
    border-radius: 50%;
    border: 2px solid white;
    animation: pulse-badge 2s infinite;
  }
  @keyframes pulse-badge {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
  }
`;
document.head.appendChild(style);

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const hamburger = document.getElementById('hamburger');
            const isOpen = menu.hasAttribute('open');
            if (isOpen) {
                menu.removeAttribute('open');
                hamburger.classList.remove('is-active');
            } else {
                menu.setAttribute('open', '');
                hamburger.classList.add('is-active');
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // This loop now only ensures the menu closes when a link is clicked,
            // relying on the <a> tag's default behavior for navigation.
            const navLinks = document.querySelectorAll('.mobile-menu a.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    // Close the menu immediately when an active link is clicked
                    toggleMobileMenu();
                });
            });
            
            // NOTE: The click event for 'hamburger' is handled by the 
            // inline 'onclick="toggleMobileMenu()"' in the HTML for simplicity.
        });

window.addEventListener('beforeunload', saveChat);

    </script>
    <script src="scripts/scroll-animation.js"></script>
    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD59PBKVQ_ocfAxWHsMsG0a3SE143Yp5zo",
    authDomain: "taxc-ebooks.firebaseapp.com",
    projectId: "taxc-ebooks",
    storageBucket: "taxc-ebooks.firebasestorage.app",
    messagingSenderId: "542476707940",
    appId: "1:542476707940:web:591fd5d3d6fd51eff95771"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const $ = id => document.getElementById(id);

  onAuthStateChanged(auth, user => {
    const loginBtns = document.querySelectorAll('#auth-button, #auth-button-mobile');
    const userDisplay = $('userDisplay');

    if (user && user.displayName) {
      const firstName = user.displayName.split(' ')[0];
      userDisplay.textContent = `Hi, ${firstName}!`;
      userDisplay.style.display = 'inline';
    } else {
      userDisplay.style.display = 'none';
    }

    // KEEP ORIGINAL LOGIN/LOGOUT BUTTON LOGIC
    loginBtns.forEach(btn => {
      if (user) {
        btn.innerHTML = 'Logout';
        btn.onclick = () => signOut(auth).then(() => location.reload());
      } else {
        btn.innerHTML = 'Login';
        btn.onclick = () => location.href = 'login.html?redirect=' + encodeURIComponent(location.href);
      }
    });
  });
</script>
</body>
</html>