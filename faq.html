<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TaxC | FAQ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="icon" href="./favicon.ico">
    <link rel="manifest" href="./site.webmanifest">

    <link rel="stylesheet" href="styles/animations.css">

    <style>

    .chat-clear {
  position: absolute;
  right: 44px; /* Moves it left of the X */
  top: 50%;
  transform: translateY(-50%);
  background: #dc3545; /* Red */
  color: #fff;
  border: none;
  font-size: 0.75rem; /* Smaller text */
  padding: 4px 8px; /* Smaller button */
  border-radius: 4px;
  cursor: pointer;
  opacity: 0.9;
}
.chat-clear:hover {
  opacity: 1;
  background: #c82333;
}

/* MOBILE FIX: Move Clear further left + smaller */
@media (max-width: 480px) {
  .chat-clear {
    right: 35px; /* Closer to center on mobile */
    font-size: 0.7rem; /* Even smaller text */
    padding: 2px 6px; /* Tighter padding */
  }
  .chat-header {
    padding: 10px 8px; /* Less padding on mobile */
    font-size: 0.9rem; /* Smaller title text */
  }
  .chat-close {
    right: 5px; /* X closer to edge */
    font-size: 1.2rem; /* Slightly smaller X */
  }
}

   /* === FLOATING CHAT (MESSAGE ICON + TOOLTIP) === */
#taxc-chat-widget {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 10000;
}

/* ——— ANIMATED FLOATING AI ICON (Makes users KNOW they can click it!) ——— */
.chat-launcher {
  position: relative;
  width: 60px;
  height: 60px;
  background: #28A745;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 20px rgba(40, 167, 69, 0.4);
  transition: all 0.3s ease;
  animation: float 6s ease-in-out infinite, pulseGlow 2s ease-in-out infinite alternate;
  z-index: 10001;
}

/* Gentle floating up & down */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-12px); }
}

/* Subtle glowing pulse */
@keyframes pulseGlow {
  from { box-shadow: 0 4px 20px rgba(40, 167, 69, 0.4); }
  to { box-shadow: 0 8px 30px rgba(40, 167, 69, 0.7); }
}

/* Hover = bigger jump + brighter glow */
.chat-launcher:hover {
  transform: translateY(-16px) scale(1.1) !important;
  box-shadow: 0 12px 40px rgba(40, 167, 69, 0.8);
  background: #218838;
}

/* Optional: tiny bounce when page loads */
@keyframes bounceIn {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.1); }
  70% { transform: scale(0.95); }
  100% { transform: scale(1); opacity: 1; }
}

.chat-launcher {
  animation: bounceIn 1s ease-out, float 6s ease-in-out infinite 1s, pulseGlow 2s ease-in-out infinite alternate;
}

/* Mobile: slightly smaller but still animated */
@media (max-width: 480px) {
  .chat-launcher {
    width: 55px;
    height: 55px;
  }
  .chat-launcher svg { width: 24px; height: 24px; }
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }
}

.chat-launcher svg { width:28px; height:28px; }

.chat-tooltip {
  position: absolute;
  right: 70px;
  top: 50%;
  transform: translateY(-50%);
  background: #333;
  color: white;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 0.85rem;
  font-weight: 600;
  white-space: nowrap;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  pointer-events: none;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.chat-tooltip::after {
  content: '';
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translateY(-50%);
  border: 6px solid transparent;
  border-left-color: #333;
}

.chat-launcher:hover .chat-tooltip {
  opacity: 1;
  visibility: visible;
  right: 68px;
}

.chat-window {
  display: none;
  width: 340px;
  height: 520px;
  background: white;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  flex-direction: column;
  overflow: hidden;
  border: 1px solid #eee;
}

.chat-header {
  background: #28A745;
  color: white;
  padding: 14px 90px 14px 40px; /* ⬅️ extra RIGHT padding */
  font-weight: 700;
  text-align: left;           /* ⬅️ important */
  position: relative;
}

.chat-header::before {
  content: "";
  display: inline-block;
  width: 8px;
  height: 8px;
  background: #fff;
  border-radius: 50%;
  margin-right: 8px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.chat-close {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: white;
  font-size: 1.4rem;
  cursor: pointer;
}

.chat-body {
  flex: 1;
  padding: 15px;
  overflow-y: auto;
  background: #f8f9fa;
}

.message {
  margin: 10px 0;
  padding: 10px 14px;
  border-radius: 18px;
  max-width: 80%;
  line-height: 1.5;
  font-size: 0.95rem;
}

.user {
  background: #28A745;
  color: white;
  margin-left: auto;
  border-bottom-right-radius: 4px;
}

.ai {
  background: white;
  color: #333;
  border: 1px solid #eee;
  margin-right: auto;
  border-bottom-left-radius: 4px;
}

.chat-input {
  display: flex;
  padding: 10px;
  border-top: 1px solid #eee;
  background: white;
}

.chat-input input {
  flex: 1;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 25px;
  font-size: 0.95rem;
}

.chat-input button {
  margin-left: 8px;
  background: #28A745;
  color: white;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
}

/* Mobile */
@media (max-width: 480px) {
  .chat-window { width: 306px; height: 480px; }
  .chat-launcher { width: 55px; height: 55px; }
  .chat-launcher svg { width: 24px; height: 24px; }
  .chat-tooltip { display: none; }
}

        /* CSS from your main application's stylesheet is integrated here for consistency */
        :root {
            /* Mapped main app colors to FAQ colors for easier maintenance */
            --green: #28A745; 
            --dark-green: #218838;
            --soft: #F8F9FA; /* Light background */
            --muted: #6c757d;
            --card: #ffffff;
            --main-color: #28A745;
            --dark-text: #343A40;
        }
        * { box-sizing: border-box; margin: 0; padding: 0 }
        body {
            font-family: 'Inter', sans-serif; /* Using 'Inter' for consistency */
            background: var(--soft); color: var(--dark-text); min-height: 100vh;
            display: flex; flex-direction: column;
            line-height: 1.6;
        }
        
        /* -------------------- Header & Navigation (Slim Style) -------------------- */
.main-header {
    background-color: var(--card);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    padding: 5px 20px; /* Slimmest vertical padding */
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 50;
}

.logo {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--main-color);
    text-decoration: none;
}

.logo-icon {
    height: 24px;
    width: 24px;
    object-fit: contain; /* Ensures favicon isn't stretched */
}

.desktop-nav {
    display: none;
    gap: 12px;
}

.desktop-nav a {
    text-decoration: none;
    color: var(--dark-text);
    padding: 8px 12px;
    transition: color 0.3s;
    font-weight: 600;
}

.desktop-nav a:hover {
    color: var(--main-color);
}

/* Show desktop nav on larger screens */
@media (min-width: 768px) {
    .desktop-nav {
        display: flex;
    }
    #hamburger {
        display: none;
    }
}

        /* Hamburger Styles */
        #hamburger {
            background: none;
            border: none;
            cursor: pointer;
            display: block; 
            padding: 0;
            width: 30px;
            height: 20px;
            position: relative;
            top: 0;
        }
        .hamburger-box {
            width: 100%;
            height: 100%;
            display: block;
            position: relative;
        }
        .hamburger-inner, .hamburger-inner::before, .hamburger-inner::after {
            position: absolute;
            height: 2px;
            width: 100%;
            background-color: var(--dark-text);
            transition: transform 0.3s ease, opacity 0.3s ease;
            left: 0;
        }
        .hamburger-inner {
            top: 50%;
            transform: translateY(-50%);
        }
        .hamburger-inner::before { 
            content: '';
            top: -8px;
        }
        .hamburger-inner::after { 
            content: '';
            bottom: -8px;
        }

        /* Active state for animation */
        .hamburger.is-active .hamburger-inner { 
            transform: translateY(-50%) rotate(45deg); 
        }
        .hamburger.is-active .hamburger-inner::before { 
            opacity: 0;
        }
        .hamburger.is-active .hamburger-inner::after { 
            transform: translateY(0) rotate(-90deg);
            top: 0;
        }

        .mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--card);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px 0;
            flex-direction: column;
            z-index: 45;
        }
        .mobile-menu[open] {
            display: flex;
        }
        .mobile-menu a {
            padding: 10px 20px;
            border-bottom: 1px solid #eee;
            text-decoration: none;
            color: var(--dark-text);
            font-weight: 600;
        }
        .mobile-menu a:hover {
            color: var(--main-color);
        }

        .cta-small { 
            background: var(--green); color: #fff; padding: 8px 14px; border-radius: 6px; border: none; cursor: pointer; 
            font-weight: 600;
        }
        .cta-small:hover { background: var(--dark-green); }

        /* -------------------- FAQ Content Styles -------------------- */
.faq-section {
    background: var(--card);
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    max-width: 800px;
    margin: 0 auto;
    overflow: hidden;
    box-sizing: border-box;
    width: 100%;               /* <-- NEW */
}

.faq-section h2 {
    color: var(--green);
    margin-bottom: 30px;
    font-size: 2rem;
    text-align: center;
    font-weight: 700;
    padding: 0 30px;
}

/* Inner wrapper for consistent padding */
.faq-inner {
    padding: 0 30px 30px; 
    overflow: hidden;          /* <-- NEW */
}

/* Each FAQ item */
.faq-item {
    margin-bottom: 0; 
    border-bottom: 1px solid #eee;
    padding: 0;
    overflow: hidden;
}

.faq-item summary {
    cursor: pointer;
    padding: 12px 0;
    font-weight: 600;
    color: var(--dark-text);
    font-size: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    list-style: none;
    user-select: none;
}
.faq-item summary::-webkit-details-marker { display: none; }

.faq-item summary::after {
    content: '';
    width: 0; height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid var(--green);
    transition: transform .2s ease-in-out;
    margin-left: 10px;
    flex-shrink: 0;
}

.faq-item[open] summary { 
    color: var(--main-color); 
}
.faq-item[open] summary::after { 
    transform: rotate(180deg); 
}

.faq-content {
    padding: 0 0 20px;
    font-size: .95rem;
    color: var(--muted);
    line-height: 1.5;
    overflow-wrap: break-word;   /* <-- NEW */
    word-break: normal;          /* <-- NEW */
}
.faq-content p { 
    margin-bottom: 10px; 
}
.faq-content a {
    color: var(--green);
    text-decoration: underline;
    font-weight: 600;
    word-break: break-word;      /* <-- NEW */
}
.faq-content a:hover { 
    color: var(--dark-green); 
}/* -------------------- End of FAQ Content Styles -------------------- */
        
        /* CTA Banner */
        .cta-banner {
            margin-top: 24px; background: #e6ffe6; /* Light Green */
            color: var(--dark-text); padding: 25px;
            border-radius: 12px; text-align: center; max-width: 800px; margin: 24px auto;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        .cta-banner h3 {
            color: var(--dark-green);
        }
        .btn-primary {
            background: var(--green); color: #fff; padding: 10px 16px; border-radius: 6px;
            border: none; cursor: pointer; font-weight: 600; transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background: var(--dark-green);
        }
        /* ==== FOOTER ==== */
.main-footer {
  margin-top: 48px;
  padding: 48px 20px 32px;
  background-color: #f9f9f9;
  border-top: 1px solid #eee;
  color: var(--muted);
  font-size: 14px;
}

.footer-container {
  max-width: 1200px;
  margin: 0 auto 40px auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 40px 60px;
  padding: 0 20px 0 70px;;           /* This line fixes the alignment perfectly */
}

.footer-section h4 {
  margin: 0 0 16px;
  font-size: 16px;
  font-weight: 600;
  color: #333;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.footer-section ul { list-style: none; padding: 0; margin: 0; }
.footer-section li { margin-bottom: 10px; }

.footer-section a {
  color: var(--muted);
  text-decoration: none;
  transition: color 0.2s ease;
}

.footer-section a:hover { color: var(--green); }

.footer-bottom {
  max-width: 1200px;
  margin: 0 auto;
  padding: 24px 20px 0;      /* Matches the 20px side padding */
  border-top: 1px solid #eee;
  text-align: center;
  font-size: 13px;
}

.footer-legal-links {
  margin-top: 8px;
  font-size: 12px;
  color: var(--muted);
}

.footer-legal-links a {
  color: var(--muted);
  text-decoration: none;
}

.footer-legal-links a:hover {
  color: var(--green);
  text-decoration: underline;
}

.social-links {
  display: flex;
  gap: 16px;
  margin-top: 8px;
}

.social-links a {
  color: var(--muted);
  transition: all 0.2s ease;
  opacity: 0.8;
}

.social-links a:hover {
  color: var(--green);
  opacity: 1;
  transform: translateY(-2px);
}

@media (max-width: 768px) {
  .footer-container {
    grid-template-columns: 1fr;
    text-align: center;
    gap: 40px;                    /* slightly more breathing room */
    padding: 0 20px !important;   /* ← THIS IS THE KEY: reset the 70px to normal on mobile */
  }

  .social-links {
    justify-content: center;
  }

  .main-footer {
    padding: 48px 20px 32px;
  }

  /* Optional: make headings a bit smaller on mobile for cleaner look */
  .footer-section h4 {
    font-size: 15px;
  }
}

        /* Media Queries */
        @media (min-width: 768px) {
            .desktop-nav { 
                display: flex;
            }
            #hamburger {
                display: none;
            }
            .container { padding-top: 100px; }
        }
        @media (max-width: 767px) {
            .faq-section { padding: 20px; }
            .faq-section h2 { font-size: 1.8rem; }
            .cta-banner div { display: flex; flex-direction: column; gap: 10px; }
            .btn-primary { margin: 5px 0 !important; width: 100%; }
        }

        .logo-container {
  display: flex;
  align-items: center;        /* Keeps everything centered */
  gap: 12px;
  height: 40px;               /* Fixed height so everything aligns perfectly */
}

/* Force the logo image to be perfectly baseline-aligned */
.logo-container .logo-icon {
  height: 28px;               /* Slightly larger than before for better balance */
  width: auto;
  vertical-align: middle;
  margin-bottom: -2px;        /* Tiny nudge to compensate for any favicon whitespace */
}

/* Make the greeting perfectly match the TaxC text height */
#userDisplay {
  display: none;              /* Hidden when not logged in */
  color: #28A745;
  font-weight: 600;
  font-size: 1.1rem;          /* Slightly bigger to match visual weight of "TaxC" */
  line-height: 1;
  margin: 0;
  padding: 0;
  white-space: nowrap;
}

@media (max-width: 480px) {
  #userDisplay {
    font-size: 1rem;  /* down from 1.1rem */
  }
}

/* ——— CHATBOT BUTTONS ——— */
.ai .chat-btn {
    display: inline-block !important;
    margin: 10px 8px 4px 0 !important;
    padding: 11px 18px !important;
    background: #28A745 !important;
    color: white !important;
    border: none !important;
    border-radius: 50px !important;
    font-size: 0.95rem !important;
    font-weight: 600 !important;
    text-decoration: none !important;
    cursor: pointer !important;
    box-shadow: 0 3px 8px rgba(40,167,69,0.3) !important;
    transition: all 0.25s ease !important;
    line-height: 1.2 !important;
}

.ai .chat-btn:hover {
    background: #218838 !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 16px rgba(40,167,69,0.4) !important;
}

/* Stack buttons nicely on mobile */
@media (max-width: 480px) {
    .ai .chat-btn {
        display: block !important;
        width: 90% !important;
        margin: 8px auto !important;
        text-align: center !important;
    }
}
        
    </style>
    <div id="taxc-chat-widget">
  <div class="chat-launcher" onclick="toggleChat()" aria-label="Chat with TaxC Assistant">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
    <div class="chat-tooltip">Chat with Ada</div>
  </div>

  <div class="chat-window" id="chat-window">
    <div class="chat-header">
      Ada — TaxC Assistant
      <button class="chat-clear" onclick="clearChat()" title="Clear chat">Clear</button>
      <button class="chat-close" onclick="toggleChat()">×</button></div>
    <div class="chat-body" id="chat-body">
    </div>
    <div class="chat-input">
      <input type="text" id="chat-input" placeholder="Type here..." onkeypress="if(event.key==='Enter')sendMessage()">
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>
</div>
</head>
<body>

<audio id="ada-message-sound" preload="auto">
  <source src="taxcaiadamessage.mp3" type="audio/mpeg">
</audio>

    <header class="main-header">
    <div class="logo-container">
  <a class="logo" href="index.html">
    <img src="./favicon.ico" alt="TaxC Logo" class="logo-icon">
    TaxC
  </a>
  <span id="userDisplay" style="display:none; color:#28A745; font-weight:600; margin-left:15px; font-size:1rem;"></span>
</div>
        <nav class="desktop-nav">
            <a href="index.html">Home</a>
            <a href="faq.html">Tax Lawyer</a>
            <a href="ebooks.html">Ebooks</a>
            <a href="index.html#calculator">Calculator</a>
            <button class="cta-small" id="auth-button"></button>
        </nav>
        
        <button id="hamburger" class="hamburger" onclick="toggleMobileMenu()">
            <span class="hamburger-box"><span class="hamburger-inner"></span></span>
        </button>
        
        <nav id="mobile-menu" class="mobile-menu" role="menu">
            <a href="index.html" class="nav-link">Home</a>
            <a href="faq.html" class="nav-link">Connect with a tax lawyer</a>
            <a href="ebooks.html" class="nav-link">Ebooks</a>
            <a href="index.html#calculator">Calculator</a>
            <button class="cta-small" id="auth-button-mobile"></button>
        </nav>
    </header>

    <main class="container">
    <section class="faq-section fade-in" id="faq" aria-labelledby="faq-heading">
        <h2 id="faq-heading">Frequently Asked Questions</h2>
        <div class="faq-inner">
            <details class="faq-item fade-in">
                <summary>What taxes does TaxC calculate?</summary>
                <div class="faq-content">
                    <p>TaxC calculates your Personal Income Tax (PIT) based on Nigeria’s 2025/2026 Nigerian Tax Act (NTA) rules. This includes income from salary, self-employment, rental, investments, and other sources, factoring in allowable deductions like pension contributions and rent relief (up to ₦500,000).</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>Who needs to pay personal income tax in Nigeria?</summary>
                <div class="faq-content">
                    <p>Every Nigerian resident earning income above ₦800,000 annually (after deductions) is required to pay Personal Income Tax to their State Internal Revenue Service (IRS). This includes salaried employees, self-employed individuals, and those with rental or investment income.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>How does TaxC handle deductions like pension and rent?</summary>
                <div class="faq-content">
                    <p>TaxC allows you to input pension contributions and annual rent paid. For salaried or self-employed individuals, rent relief is calculated as 20% of your rent, capped at ₦500,000. These deductions reduce your taxable income, lowering your tax liability. Other deductions may include life insurance, NHF, etc.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>What is Withholding Tax (WHT), and how is it applied?</summary>
                <div class="faq-content">
                    <p>Withholding Tax (WHT) is a tax deducted at source on certain incomes, like rental income (10%), or investment income (10%). TaxC lets you input WHT paid or applies default rates, which are credited against your final tax liability to avoid double taxation.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>Is my data safe with TaxC?</summary>
                <div class="faq-content">
                    <p>Yes, TaxC prioritizes your privacy. We don’t store sensitive payment information—payments are securely handled by Paystack. Your input data is used only for calculations and report generation, and we adhere to strict data protection standards.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>What’s included in the ₦500 PDF report?</summary>
                <div class="faq-content">
                    <p>The PDF report includes a step-by-step breakdown of your tax calculation, deduction summary (pension, rent relief, etc), tax band details, and filing guidance tailored to your state’s IRS. It’s perfect for keeping records or sharing with a tax lawyer.</p>
                    <p><a href="index.html#calculator">Calculate now</a> to get your report!</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>How do I file my taxes after using TaxC?</summary>
                <div class="faq-content">
                    <p>TaxC provides an estimate to guide you. To file, submit your tax details to your State IRS, either online via their portal or in person. Our ₦500 report includes specific filing guidance for your state. You can also <a href="javascript:void(0)" onclick="openChat()">Chat with AI</a> for personalized help.</p>
                </div>
            </details>
            <details class="faq-item fade-in">
                <summary>Can TaxC help with company or corporate taxes?</summary>
                <div class="faq-content">
                    <p>Currently, TaxC focuses on Personal Income Tax for individuals. For corporate taxes, consult a tax professional or contact your State IRS. Our <a href="ebooks.html">eBooks</a> may offer additional resources for company owners.</p>
                </div>
            </details>
        </div>
    </section>

    <section class="cta-banner fade-in">
        <h3>Got more questions? Check ebooks or chat with AI!</h3>
        <div style="margin-top: 15px">
            <button class="btn-primary" onclick="window.location.href='ebooks.html'">Ebooks</button>
            <button class="btn-primary" style="margin-left: 10px;" onclick="openChat()">Chat with Ada</button>
        </div>
    </section>
</main>

<footer class="main-footer fade-in">
  <div class="footer-container">

    <div class="footer-section">
      <h4>Product</h4>
      <ul>
        <li><a href="index.html#calculator">Calculator</a></li>
        <li><a href="ebooks.html">Ebooks & Guides</a></li>
        <li><a href="index.html#lawyer">Connect with a Tax Lawyer</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h4>Support</h4>
      <ul>
        <li><a href="faq.html">FAQ</a></li>
        <li><a href="mailto:support@taxc.com.ng">support@taxc.com.ng</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h4>Legal</h4>
      <ul>
        <li><a href="privacy.html">Privacy Policy</a></li>
        <!-- <li><a href="terms.html">Terms of Service</a></li> -->
      </ul>
    </div>

    <!-- Social Media Column -->
    <div class="footer-section">
      <h4>Follow Us</h4>
      <div class="social-links">
        <a href="https://instagram.com/taxc.com.ng" target="_blank" rel="noopener" aria-label="Instagram">
          <!-- Instagram SVG -->
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
        </a>
        <a href="https://linkedin.com/company/taxc-com-ng" target="_blank" rel="noopener" aria-label="LinkedIn">
          <!-- LinkedIn SVG -->
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.761 0 5-2.239 5-5v-14c0-2.761-2.239-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
        </a>
      </div>
    </div>

  </div>

  <div class="footer-bottom">
    <p>© 2025 TaxC, All rights reserved.</p>
    <p class="footer-legal-links">
      <a href="privacy.html">Privacy</a> • 
      <a href="mailto:support@taxc.com.ng">Contact</a>
    </p>
  </div>
</footer>

<script>

function openChat(){
  toggleChat();                     // open the widget
  document.getElementById('chat-input').focus(); // put cursor in the box
}

const Ada = {
  memory: { name: "", state: "" },

  init() {
    const savedName = localStorage.getItem('taxc_user_name');
    const savedState = localStorage.getItem('taxc_user_state');
    if (savedName) this.memory.name = savedName;
    if (savedState) this.memory.state = savedState;
  },

  saveName(name) {
    this.memory.name = name.trim();
    localStorage.setItem('taxc_user_name', this.memory.name);
  },

    saveState(state) {
    this.memory.state = state.trim();
    localStorage.setItem('taxc_user_state', this.memory.state);
  },

  logUnanswered(input) {
  if (!input || typeof input !== 'string') return;
  const l = input.toLowerCase().trim();
  if (l.length < 3) return;
  if (/^(hi|hello|hey|howfar|good morning|gm|fine|good|okay|my name is|call me|i am|i live in|my state)/i.test(input)) return;

  // FOR TESTING: show in console on localhost and GitHub Pages
  if (location.hostname === "localhost" || 
      location.hostname === "127.0.0.1" || 
      location.href.includes("ejayszn.github.io")) {
    console.log("UNANSWERED (test mode):", input.trim());
  }

  // ONLY SEND TO GOOGLE SHEET WHEN ON REAL DOMAIN
  if (location.hostname === "taxc.com.ng" || location.hostname === "www.taxc.com.ng") {
    fetch('https://script.google.com/macros/s/AKfycbzIC7c4nrfj-EDY9212GRlH0uG_0Y6xsKmaj9k73IcTHzD8BkKUl71-6jVj0BtQH0csUw/exec', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        message: input.trim(), 
        timestamp: new Date().toISOString(),
        page: location.href
      })
    }).catch(() => {});
  }
},

  randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  },

  greet() {
    return this.memory.name ? `Welcome back, ${this.memory.name}.` : "";
  },

  respond(input) {
    this.logUnanswered(input);
    let cleanQuestion = input.trim();
    const l = input.toLowerCase().trim();
    const name = this.memory.name || "there";

    // === 1. PROFESSIONAL GREETINGS ===
    if (/^(hi|hello|hey|howfar|good morning|gm|afternoon|evening|hi ada|hello ada)/i.test(input)) {
      return this.randomChoice([
        `Hello ${name}. How can I assist you with your taxes today?`,
        `Hi ${name}. Welcome. What would you like to know?`,
        `Good to see you${this.memory.name ? ", " + this.memory.name : ""}. How may I help?`
      ]);
    }

    // === 2. USER SAYS THEY'RE FINE ===
    if (/fine|good|okay|great|blessed|not bad/i.test(l)) {
      return `Excellent. How can I assist you today?`;
    }

    // === 3. ORIGINAL PROFESSIONAL FAQS (100% restored) ===
    const faqTriggers = {
      "what taxes does taxc calculate": "TaxC calculates your Personal Income Tax (PIT) based on Nigeria’s 2025/2026 Nigerian Tax Act (NTA) rules. This includes income from salary, self-employment, rental, investments, and other sources, factoring in allowable deductions like pension contributions and rent relief (up to ₦500,000).",
      "who needs to pay personal income tax": "Every Nigerian resident earning income above ₦800,000 annually (after deductions) is required to pay Personal Income Tax to their State Internal Revenue Service (IRS). This includes salaried employees, self-employed individuals, and those with rental or investment income.",
      "how does taxc handle deductions": "TaxC allows you to input pension contributions and annual rent paid. For salaried or self-employed individuals, rent relief is calculated as 20% of your rent, capped at ₦500,000. These deductions reduce your taxable income, lowering your tax liability. Other deductions may include life insurance, NHF, etc.",
      "what is withholding tax": "Withholding Tax (WHT) is a tax deducted at source on certain incomes, like rental income (10%), or investment income (10%). TaxC lets you input WHT paid or applies default rates, which are credited against your final tax liability to avoid double taxation.",
      "is my data safe": "Yes, TaxC prioritizes your privacy. We don’t store sensitive payment information. Payments are securely handled by Interswitch. Your input data is used only for calculations and report generation, and we adhere to strict data protection standards.",
      "what’s included in the pdf report": "The PDF report includes a step-by-step breakdown of your tax calculation, deduction summary (pension, rent relief, etc), tax band details, and filing guidance tailored to your state’s IRS. It’s perfect for keeping records or sharing with a tax lawyer.",
      "how do i file my taxes": "TaxC provides an estimate to guide you. To file, submit your tax details to your State IRS, either online via their portal or in person. Our ₦500 report includes specific filing guidance for your state.",
      "can taxc help with business taxes": "Currently, TaxC focuses on Personal Income Tax for individuals. For business or corporate taxes, consult a tax professional or contact your State IRS. Our eBooks may offer additional resources for business owners."
    };

    for (const [trigger, answer] of Object.entries(faqTriggers)) {
      const keywords = trigger.toLowerCase().split(" ").filter(w => w.length > 3);
      if (keywords.every(k => l.includes(k))) return answer;
    }

    // === ALL HIGH-PROBABILITY QUESTIONS RESTORED (Professional English) ===

    if (l.includes("am i tax eligible") || l.includes("who must pay tax") || l.includes("who pays tax") || l.includes("personal income tax") || l.includes("do I need to pay tax in nigeria") || l.includes("unemployed")) {
      return `You are required to pay Personal Income Tax if your total annual income exceeds ₦800,000 after deductions.<br><br>The first ₦800,000 is completely tax-free.<br><br><button class="chat-btn" onclick="location.href='index.html#calculator'">Check Your Eligibility</button>`;
    }

    if (l.includes("tax on gifts")) {
      return `No. Gifts received by individuals are fully exempt from Personal Income Tax under the 2026 Nigeria Tax Act.`;
    }

    if (l.includes("tax on allowance")) {
      return `Most allowances are taxable. However, medical reimbursements, leave allowance (up to limits), and certain transport subsidies may qualify for relief.`;
    }

    // Refined: Use regex for more precise matching
    if (/bank.*deduct.*tax/.test(l)) {
      return `No. Banks do not automatically deduct Personal Income Tax from accounts. They only report high-value transactions above ₦25 million monthly. PAYE is deducted by employers.`;
    }

    if (l.includes("minimum wage") && l.includes("tax") || l.includes("70k") && l.includes("tax")) {
      return `No. The ₦70,000 minimum wage (₦840,000/year) is mostly within the tax-free threshold of ₦800,000. Minimum wage earners pay little or no tax.`;
    }

    if (l.includes("pensioner") || l.includes("retiree") || l.includes("retired") || l.includes("pension tax")) {
      return `Pension income is taxable under PIT, but you get full relief on contributions during working years.<br><br>Tax-free elements: Lump-sum withdrawals up to limits, gratuity.<br><br>Many retirees pay minimal tax due to reliefs.<br><br><button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate Pension Tax</button>`;
    }

    if (l.includes("capital gains") || l.includes("tax on profit") || l.includes("sell asset") || l.includes("stock tax") || l.includes("property sale tax")) {
      return `Capital Gains Tax (CGT) is 10% on profits from selling assets like shares, land, or vehicles (exempt for personal residence).<br><br>It's separate from PIT but reported in your annual filing.<br><br>Calculate your CGT liability here.<br><br><button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate CGT</button>`;
    }

    if (l.includes("refund") || l.includes("overpaid") || l.includes("get money back") || l.includes("excess tax")) {
      return `If you've overpaid (e.g., via excess PAYE or WHT), you can claim a refund when filing your annual return.<br><br>Process:<br>• Submit proof to your State IRS<br>• Refunds are issued via bank transfer or credit against future tax<br><br>Audit your payments with our calculator.<br><br><button class="chat-btn" onclick="location.href='index.html#calculator'">Check for Refund</button>`;
    }

    if (l.includes("audit") || l.includes("irs notice") || l.includes("tax investigation") || l.includes("what if audited")) {
      return `If audited, provide records like payslips, receipts, and bank statements.<br><br>Stay compliant by filing on time. Audits are random or triggered by discrepancies.<br><br>Our guides can help prepare.<br><br><button class="chat-btn" onclick="location.href='ebooks.html#free'">Get Audit Guide</button>`;
    }

    if (l.includes("side hustle") || l.includes("gig") || l.includes("uber") || l.includes("bolt") || l.includes("online business") || l.includes("extra income tax")) {
      return `Income from side hustles is taxable as self-employment income under PIT.<br><br>Deduct business expenses (e.g., fuel, data) to reduce liability.<br><br>File quarterly if income > ₦25m/year.<br><br><button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate Side Income Tax</button>`;
    }

    if (l.includes("crypto") || l.includes("bitcoin") || l.includes("usdt")) {
      return `Yes. Profit from selling cryptocurrency attracts 10% Capital Gains Tax. Income earned in crypto is taxed as regular income.`;
    }

    if (l.includes("non-resident") || l.includes("expat") || l.includes("foreigner") || l.includes("work in nigeria") || l.includes("tax for foreigner")) {
      return `Non-residents pay PIT only on Nigeria-sourced income.<br><br>If here >183 days, you're a resident and taxed on worldwide income.<br><br>Double taxation treaties may apply.<br><br>Consult a professional for your case.<br><br><button class="chat-btn" onclick="location.href='https://taxc.com.ng/lawyer'">Connect With Expert</button>`;
    }

    if (l.includes("vat") || l.includes("value added tax")) {
      return `TaxC specializes in Personal Income Tax. VAT is a separate 7.5% consumption tax handled by FIRS.<br><br>For PIT-related queries, I'm here. Otherwise, check our eBooks for basics.<br><br><button class="chat-btn" onclick="location.href='ebooks.html#free'">Download VAT Guide</button>`;
    }

    if (l.includes("new law") || l.includes("tax change") || l.includes("2026 update") || l.includes("recent amendment")) {
      return `Key 2026 changes: Tax-free threshold raised to ₦800,000; rent relief capped at ₦500,000; progressive rates up to 25%.<br><br>Stay updated with our resources.<br><br><button class="chat-btn" onclick="location.href='ebooks.html#free'">Get Latest Updates</button>`;
    } 

    if (l.includes("appeal") || l.includes("disagree") || l.includes("contest tax") || l.includes("wrong assessment")) {
      return `You can appeal to your State IRS within 30 days of assessment.<br><br>Provide evidence; escalate to Tax Appeal Tribunal if needed.<br><br>Our lawyers can assist.<br><br><button class="chat-btn" onclick="location.href='https://taxc.com.ng/lawyer'">Get Appeal Help</button>`;
    }

    if (l.includes("register tin") || l.includes("get tin") || l.includes("apply for tin")) {
      return `Apply for TIN via JTB website (jtb.gov.ng), USSD (*3322#), or State IRS office with your BVN/NIN and ID.<br><br>It's free and takes minutes online.`;
    }

    // === LANDLORD / RENTAL INCOME TAX (Fixes the "I am a landlord" bug) ===
    // Refined: More precise with regex
    if (l.includes("landlord") || l.includes("rental income") || l.includes("rent i collect") || /tenant.*tax/.test(l)) {
      return `
        Yes, as a landlord you must pay Personal Income Tax on rental income.<br><br>
        Key points:<br>
        • Rental income is taxed at your normal PIT rate<br>
        • Your tenant should deduct 10% Withholding Tax (WHT) and remit it — you get credit<br>
        • You still file annually and declare the full amount<br><br>
        Want to calculate your exact tax on rental income?<br><br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate Landlord Tax</button>
      `;
    }

    // Refined: Regex for employer not deduct
    if (/employer.*(deduct|paye|tax|withhold)|deduct.*(employer|paye)|already.*(deduct|paye)/i.test(l)) {
  return `Your employer is legally required to deduct PAYE monthly from your salary and remit it to the tax authority. If they are not doing it, you remain personally liable and must file/pay yourself before 31 March to avoid penalties.`;
}

    if (l.includes("paye") || l.includes("wetin be paye") || l.includes("payee")) {
      return `PAYE (Pay As You Earn) is tax your employer deducts monthly from your salary and remits to the government. You still need to file annually to reconcile.`;
    }

    if (/student.*pay tax/.test(l) || /nysc.*tax/.test(l)) {
      return `Students in Nigeria pay no tax on scholarships, bursaries, or allowances, these are fully exempt under the Personal Income Tax Act. However, if a student earns other income (for example, from freelance work, a business, or employment) that exceeds ₦800,000 per annum after applying deductions, that portion becomes taxable. In practice, the vast majority of full-time students fall below this threshold and remain completely tax-free. NYSC allowance is mostly tax-free or attracts minimal PAYE.`;
    }

    if (/pay.*tax|tax.*pay|dont.*pay|not.*pay|fail.*pay|non.*pay|evade|avoid.*tax|consequence.*tax|what.*happen.*not.*pay/i.test(l)) {
  return `Not paying tax in Nigeria leads to penalties: 10% of the unpaid amount + 1.25% monthly interest. Serious cases can result in fines up to ₦1 million, asset seizure, or up to 3 years in prison under NTA 2025. Pay on time to avoid!`;
}

    if (l.includes("previous year") || l.includes("never filed") || l.includes("back tax")) {
      return `Yes, you can file for previous years now. Penalties apply, but voluntary filing reduces them. Many states offer waiver programmes.`;
    }

    if (l.includes("tin") || l.includes("tax identification number")) {
      return `Retrieve your TIN via verify.jtb.gov.ng, *3322#, old payslip, or any State IRS office with your BVN/NIN.`;
    }

    // Refined: Regex for landlord receipt
    if (/landlord.*receipt/.test(l)) {
      return `You can still claim rent relief using bank transfers, tenancy agreement + affidavit, or electronic receipts. TaxC accepts these.`;
    }

    if (l.includes("two states") || /which state.*pay/.test(l)) {
      return `You pay PIT to the state where you reside or work for more than 183 days per year.`;
    }

    // Refined: More precise
    if (/married|spouse|children.*relief/.test(l)) {
      return `Nigeria uses individual filing only. Consolidated relief: 20% of income + ₦200,000. Child allowance: ₦2,500 per child (max 4).`;
    }

    if (l.includes("lost job") || /unemployed.*file/.test(l)) {
      return `Yes, you should still file a Nil return to maintain a clean tax record.`;
    }

    if (l.includes("freelance") || l.includes("remote") || l.includes("self-employed")) {
      return `Freelancers and remote workers (basically people who do not work in a structured Nigerian organization) must register with their State IRS, file annually by 31 March, and may pay advance tax quarterly. TaxC guides you step by step.`;
    }

    // Refined: Regex
    if (/who.*collect.*tax|where.*pay.*tax|which.*irs|tax.*authority|fir.*state|state.*irs|tax.*collected.*(fir|state)/i.test(l)) {
      return `Pay via your State IRS portal or designated banks. Example: Lagos → paydirect.lirs.net`;
    }

    if (l.includes("installment") || l.includes("part payment")) {
      return `Some states allow installments with prior approval. Lagos does NOT permit PIT installments.`;
    }

    // Refined: Regex
    if (/arrest|jail.*tax/.test(l)) {
      return `No. Tax debt alone does not lead to arrest. Extreme cases may result in account restrictions.`;
    }

    if (l.includes("tcc") || l.includes("tax clearance")) {
      return `After filing and payment, apply on your State IRS portal. Usually issued instantly or within 48 hours.`;
    }

    // Refined: Regex
    if (/how often.*file/.test(l) || l.includes("file every month") || l.includes("monthly") || l.includes("yearly")) {
      return `You file Personal Income Tax returns once per year (by 31 March). PAYE is deducted monthly by employers automatically.`;
    }

    if (/when.*pay.*tax/.test(l) || l.includes("deadline")) {
      return `Deadline for annual filing and final payment: 31 March of the following year.`;
    }

    if (l.includes("not pay tax") || l.includes("tax free") || l.includes("exempt")) {
      return `Tax-free items include: gifts, scholarships, inheritance, proceeds from personal residence sale, NYSC allowance (mostly), lottery winnings, life insurance payouts.`;
    }

    // Pidgin additions + typos
    if ((l.includes("calculate") || l.includes("how much tax") || l.includes("owe") || l.includes("how much tax i go pay") || l.includes("wetin i go pay")) && !l.includes("state")) {
      return `Let me calculate your exact tax liability.<br><br><button class="chat-btn" onclick="location.href='index.html#calculator'">Open Calculator</button>`;
    }

    if (l.includes("free") || l.includes("ebook") || l.includes("download")) {
      return `Free tax guides are available.<br><br><button class="chat-btn" onclick="location.href='ebooks.html#free'">Download Now</button>`;
    }

    // === EXTRA QUERIES FROM OLD V2.0 (Now Clean & Professional) ===

    // 1. What is my tax band? + typos + pidgin
    if (l.includes("what band") || l.includes("which band") || l.includes("my band") || l.includes("what tax band do i fall") || l.includes("tax bannd") || l.includes("tax brackett") || l.includes("tax bracked") || l.includes("wetin be tax band") || l.includes("which tax band i dey")) {
      return `To determine your exact tax band, I need your total annual income (salary + other sources).<br><br>Please click on the button below, share an estimate, and get the PDF report(It contains the tax bands) and I will tell you immediately.<br><br><button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate Now</button>`;
    }

    // 2. How was your night? / How are you? (already has pidgin "how you dey")
    if (l.includes("how was your night") || l.includes("how your night") || l.includes("how are you") || l.includes("how you dey")) {
      return `I'm functioning perfectly and ready to help you with your taxes. How may I assist you today?`;
    }

    // 3. Are you an AI or chatbot?
    if (l.includes("are you an ai") || l.includes("artificial intelligence") || l.includes("chat bot or ai") || l.includes("are you a chat bot?") || l.includes("are you ai?") || l.includes("bot?")) {
      return `I am a smart chatbot designed specifically to help Nigerians understand and calculate Personal Income Tax under the 2025/2026 rules. I provide accurate, instant answers based on the latest tax laws.`;
    }

    // 4. Who made you / Who created TaxC?
    if (l.includes("who made you") || l.includes("who created") || l.includes("creator") || l.includes("who made taxc")) {
      return `TaxC and I (Ada) were created by Emmanuel Oguibe, a Nigerian tax expert dedicated to making tax simple and accessible for everyone.`;
    }

    // 5. How can I save money on tax? / Reduce tax? + pidgin
    if ((l.includes("save money") && l.includes("tax")) || l.includes("reduce tax") || l.includes("pay less tax") || l.includes("how i fit save for tax") || l.includes("abeg how to reduce tax") || l.includes("rent reduce my")) {
      return `You can legally reduce your tax through:<br><br>
        • Rent relief (up to ₦500,000)<br>
        • Pension contributions<br>
        • NHF and NHIS (where applicable)<br>
        • Business expense deductions (self-employed)<br><br>
        Many Nigerians save ₦500,000–₦3 million annually by claiming these correctly.<br><br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">See How Much You Can Save</button>`;
    }

    // 6. Simple explanations for key terms (WHT, PAYE, Rent Relief, etc.) + pidgin + typos
    if (l.includes("wht") || l.includes("withholding tax") || l.includes("wetin be wht") || l.includes("withholiding tax") || l.includes("witholding")) {
      return `Withholding Tax (WHT) is tax deducted at source before payment is made to you. Example: Tenant deducts 10% from rent and pays it directly to government. You get credit for it when filing.`;
    }
    if (l.includes("rent relief") || l.includes("wetin be rent relief") || l.includes("rent releif") || l.includes("rent relif")) {
      return `Rent relief allows you to deduct up to ₦500,000 from your taxable income if you pay house rent. This can save you tens or hundreds of thousands in tax.`;
    }

    // Consolidated Relief Allowance
if (/consolidated.*relief|relief.*allowance|CRA/i.test(l)) {
  return `Under the Nigeria Tax Act 2025 (effective January 1, 2026), the Consolidated Relief Allowance (CRA) has been abolished and replaced by a rent relief: 20% of annual rent paid, capped at ₦500,000 (for renters only). Homeowners get no equivalent relief. The first ₦800,000 of income remains tax-free via the new progressive bands, so most people earning ≤ ₦800k per year pay little or no tax.`;
}

    // 7. Off-topic / inappropriate redirection (clean version)
    if (/(love you|marry|boyfriend|girlfriend|date|send pic|nude|sexy|horny|sex)/i.test(l)) {
      return `Let's stay focused on helping you with your taxes. That's what I'm here for. How can I assist you today?`;
    }

    // What is your name? + pidgin
    if (l.includes("what is your name") || l.includes("whats your name") || l.includes("who are you") || l.includes("wetin be your name") || l.includes("who you be")) {
      return `My name is Ada. I am your dedicated digital tax assistant.`;
    }

    // Are the calculations accurate / correct?
    if (l.includes("accurate") || l.includes("correct") || l.includes("can i trust") || l.includes("calculations")) {
      return `Yes. All TaxC calculations strictly follow the official 2025/2026 Nigerian Tax Act.<br><br>For complex cases or extra peace of mind, you can connect with a verified tax lawyer here:<br><br>
        <button class="chat-btn" onclick="location.href='https://taxc.com.ng/lawyer'">Connect With Tax Lawyer</button>`;
    }

    // === WHAT ARE THE TAX BANDS? (2026 Nigerian PIT Rates – Clean & Beautiful) + typos + pidgin
    if (l.includes("tax band") || l.includes("tax rate") || l.includes("tax bracket") || l.includes("how much percent") || l.includes("tax table") || l.includes("pit rate") || l.includes("tax bannd") || l.includes("tax brackett") || l.includes("tax bracked") || l.includes("wetin be tax rate") || l.includes("how much percent tax")) {
      return `
        Here are the official 2026 Personal Income Tax rates in Nigeria:<br><br>
        • First ₦800,000 of taxable income → <strong>0% (completely tax-free)</strong><br>
        • Next ₦2,200,000 (₦800,001 – ₦3,000,000) → <strong>15%</strong><br>
        • Next ₦9,000,000 (₦3,000,001 – ₦12,000,000) → <strong>18%</strong><br>
        • Next ₦13,000,000 (₦12,000,001 – ₦25,000,000) → <strong>21%</strong><br>
        • Next ₦25,000,000 (₦25,000,001 – ₦50,000,000) → <strong>23%</strong><br>
        • Anything above ₦50,000,000 → <strong>25%</strong><br><br>

        <em>Example:</em> If your taxable income is ₦5 million:<br>
        → First ₦800k = ₦0 tax<br>
        → Next ₦2.2m = ₦330,000 tax<br>
        → Remaining ₦2m = ₦360,000 tax<br>
        <strong>Total tax = ₦690,000</strong><br><br>

        Want to know exactly how much you’ll pay?<br><br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate My Tax Now</button>
      `;
    }

    // === IS STATE NEEDED IN TAX CALCULATION? (NOW CATCHES EVERYTHING) ===
    if (
      l.includes("state") && (
        l.includes("need") || 
        l.includes("require") || 
        l.includes("important") || 
        l.includes("necessary") ||
        l.includes("why") && l.includes("state") ||
        l.includes("do you") && l.includes("state") ||
        l.includes("matter")
      )
    ) {
      return `
        Yes, your state of residence is needed for an accurate and complete tax result.<br><br>
        Here’s why:<br>
        • Personal Income Tax is paid to your State Internal Revenue Service (not federal)<br>
        • The final PDF report TaxC generates must show the correct state so you can file properly<br>
        • Some states have small differences in approved deductions or filing rules<br><br>
        It only takes 2 seconds to select your state in the calculator — everything else is automatic.<br><br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Start Calculation → Choose Your State</button>
      `;
    }

    // === NAME & STATE (Professional) ===
    if (l.includes("my name is") || l.includes("call me") || l.includes("i am")) {
      const match = input.match(/(?:my name is|call me|i'm|my name|name is )([\w\s]+)/i);
      if (match) {
        this.saveName(match[1]);
        return `Thank you, ${this.memory.name}. I have saved your name. How may I assist you?`;
      }
    }

    if (l.includes("what is my name") || l.includes("remember my name")) {
      return this.memory.name ? `Yes, your name is ${this.memory.name}.` : `You haven’t shared your name yet.`;
    }

    if (l.includes("my state") || l.includes("i live in") || l.includes("i stay in")) {
      const states = [
  "abuja", "fct", "abia", "adamawa", "akwa ibom", "anambra", "bauchi", "bayelsa",
  "benue", "borno", "cross river", "delta", "ebonyi", "edo", "ekiti", "enugu",
  "gombe", "imo", "jigawa", "kaduna", "kano", "katsina", "kebbi", "kogi",
  "kwara", "lagos", "nasarawa", "niger", "ogun", "ondo", "osun", "oyo",
  "plateau", "rivers", "sokoto", "taraba", "yobe", "zamfara"
];
      for (const s of states) {
        if (l.includes(s)) {
          this.saveState(s.charAt(0).toUpperCase() + s.slice(1));
          return `Noted. You are in ${this.memory.state}. Tax rules vary slightly by state.`;
        }
      }
    }

    // Edge case: Very short inputs like "tax?" or "tax"
    if (l === "tax" || l === "tax?" || l === "pit" || l === "pit?") {
      return `
        Hello${this.memory.name ? ", " + this.memory.name : ""}.<br><br>
        Personal Income Tax (PIT) is a tax on your earnings in Nigeria. How can I help you with it today?<br><br>
        <button class="chat-btn" onclick="location.href='index.html#calculator'">Calculate My Tax</button>
      `;
    }

    // === SAFE LATE FILING / PENALTY (won’t eat normal questions anymore) ===
if (/penalty|late.*(filing|payment|file|submission)|file.*late|overdue|miss.*deadline/i.test(l)) {
  return `Late filing: ₦50,000 for individuals (may be ₦5,000 fine + ₦100/day depending on state/LGA)<br>Late payment: 10% penalty per annum + interest at the prevailing CBN rate<br>File on time to avoid these charges.`;
}

    // === FINAL FALLBACK ===
    
    let responseText = "";
    
    // Check if the user asked a question (cleanQuestion is the input)
    // 2. Access cleanQuestion, which is now defined.
    if (cleanQuestion) { // <--- The error happens if this runs before the line above
        // Option 1: Acknowledge the question specifically
        responseText = `
            Sorry, I couldn't find a direct answer to your inquiry about <strong>"${cleanQuestion}"</strong>.
        `;
    } else {
        // Option 2: Generic greeting if no question was asked
        responseText = `${this.greet() ? this.greet() : "Hello."}`;
    }

    // Now combine the custom response with the list of capabilities
    return `
    ${responseText}<br><br>
    However, I can definitely help if you have any other questions like tax calculation, deductions, etc.
    <div style="margin-top:12px;">
        <a href="index.html#calculator" class="chat-btn">Calculate My Tax</a>
        <a href="ebooks.html#free" class="chat-btn">Download Free Guides</a>
    </div>
`;
} 
};

// === CHAT UI ===
let hasNewMessage = false;

function toggleChat() {
  const win = document.getElementById('chat-window');
  const launcher = document.querySelector('.chat-launcher');
  win.style.display = win.style.display === 'flex' ? 'none' : 'flex';
  if (win.style.display === 'flex') {
    hasNewMessage = false;
    launcher.classList.remove('has-notification');
    // ⭐ NEW: Clear the unread status when the chat is opened/read
    localStorage.removeItem('taxc_ai_has_unread'); 

    setTimeout(() => document.getElementById('chat-input')?.focus(), 300);
    setTimeout(scrollToBottom, 100);
  }
}

// -------------------------------------------------
// SAVE CHAT HISTORY TO LOCALSTORAGE
// -------------------------------------------------
function saveChat() {
  const messages = [];
  document.querySelectorAll('#chat-body .message').forEach(msg => {
    messages.push({
      text: msg.innerHTML,
      type: msg.classList.contains('user') ? 'user' : 'ai'
    });
  });
  localStorage.setItem('taxc_chat_history', JSON.stringify(messages));
}

function scrollToBottom() {
  const body = document.getElementById('chat-body');
  if (body) {
    body.scrollTop = body.scrollHeight;
    body.scrollIntoView({ behavior: 'smooth', block: 'end' });
  }
}

function addMessage(text, type, isInitialLoad = false) {
  const body = document.getElementById('chat-body');
  const div = document.createElement('div');
  div.className = `message ${type}`;
  div.innerHTML = text;
  body.appendChild(div);
  
  // Scroll to bottom
  scrollToBottom();

  // === PLAY SOUND ONLY FOR ADA'S REAL REPLY (not loading dots) ===
  if (type === 'ai' && window.adaSound && !text.includes('typing')) {
    window.adaSound.currentTime = 0;
    window.adaSound.play().catch(() => {});
  }

  // === NOTIFICATION BUBBLE (when chat is closed) ===
  // Trigger only if it's an AI message, NOT an initial load, and the chat is closed
  if (type === 'ai' && !isInitialLoad && document.getElementById('chat-window').style.display !== 'flex') {
    hasNewMessage = true;
    document.querySelector('.chat-launcher').classList.add('has-notification');
    // ⭐ NEW: Persist the unread status in localStorage
    localStorage.setItem('taxc_ai_has_unread', 'true'); 
  }
}

// -------------------------------------------------
// CLEAR CHAT + CONFIRM
// -------------------------------------------------
function clearChat() {
  if (confirm("Are you sure you want to clear chat?")) {
    document.getElementById('chat-body').innerHTML = '';
    localStorage.removeItem('taxc_chat_history');
  }
}

function sendMessage() {
  const input = document.getElementById('chat-input');
  const text = input.value.trim();
  if (!text) return;

  addMessage(text, 'user');
  input.value = '';
  addMessage('<i class="typing">•••</i>', 'ai');

  setTimeout(() => {
    const messages = document.querySelectorAll('.message');
    if (messages.length > 0) messages[messages.length - 1].remove();
    addMessage(Ada.respond(text), 'ai');
  }, 1000);
}

document.addEventListener('DOMContentLoaded', () => {
  Ada.init();
  
  // ⭐ NEW: Check and apply saved notification status immediately on page load
  const launcher = document.querySelector('.chat-launcher');
  if (localStorage.getItem('taxc_ai_has_unread') === 'true') {
    launcher.classList.add('has-notification');
  }

  // ==== LOAD PREVIOUS CHAT ====
  const savedChat = localStorage.getItem('taxc_chat_history');
  if (savedChat) {
    const messages = JSON.parse(savedChat);
    // Pass 'true' to ensure history re-load doesn't re-trigger notification
    messages.forEach(msg => addMessage(msg.text, msg.type, true)); 
    setTimeout(scrollToBottom, 100);
  }

  // === INIT ADA SOUND ===
  const adaSound = document.getElementById('ada-message-sound');
  if (adaSound) {
    adaSound.volume = 0.6;
    window.adaSound = adaSound;
  }

  // ==== FIRST-TIME WELCOME (if no name & no chat) ====
  if (!Ada.memory.name && !savedChat) {
    // Pass 'true' to prevent this greeting from triggering a notification
    addMessage("Hi! I'm <strong>Ada</strong>, your digital tax assistant. Ask me anything about taxes, filing, or ebooks!", 'ai', true); 
  }

  // === ONLY SHOW "WELCOME BACK" IF NO CHAT HISTORY ===
  if (Ada.memory.name) {
    const hasChat = localStorage.getItem('taxc_chat_history') && 
                    JSON.parse(localStorage.getItem('taxc_chat_history')).length > 0;
    
    if (!hasChat) {
      setTimeout(() => {
        // Pass 'true' to prevent this greeting from triggering a notification
        addMessage(`Welcome back, ${Ada.memory.name}! Howfar today?`, 'ai', true); 
      }, 800);
    }
  }
});

// === CSS: Notification Badge + Clean Numbers ===
const style = document.createElement('style');
style.textContent = `
  .chat-btn {
    background: #28A745; color: white; border: none; padding: 10px 18px;
    border-radius: 8px; cursor: pointer; font-weight: 600; margin: 8px 0;
    display: inline-block; font-size: 0.95rem; box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    transition: all 0.2s;
  }
  .chat-btn:hover { background: #218838; transform: translateY(-1px); }

  .typing { animation: blink 1s infinite; }
  @keyframes blink { 0%,100% { opacity: 1 } 50% { opacity: 0.3 } }

  /* === FIXED: Clean Numbering === */
  .message ol {
    counter-reset: item;
    padding-left: 0;
    margin: 12px 0;
  }
  .message ol li {
    display: block;
    margin: 10px 0;
    padding-left: 30px;
    position: relative;
    line-height: 1.5;
  }
  .message ol li:before {
    content: counter(item);
    counter-increment: item;
    position: absolute;
    left: 0;
    background: #28A745;
    color: white;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 0.85rem;
  }

  /* === NOTIFICATION BADGE === */
  .chat-launcher {
    position: relative;
  }
  .chat-launcher.has-notification::after {
    content: '';
    position: absolute;
    top: 8px;
    right: 8px;
    width: 12px;
    height: 12px;
    background: #ff3b30;
    border-radius: 50%;
    border: 2px solid white;
    animation: pulse-badge 2s infinite;
  }
  @keyframes pulse-badge {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
  }
`;
document.head.appendChild(style);

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const hamburger = document.getElementById('hamburger');
            const isOpen = menu.hasAttribute('open');
            if (isOpen) {
                menu.removeAttribute('open');
                hamburger.classList.remove('is-active');
            } else {
                menu.setAttribute('open', '');
                hamburger.classList.add('is-active');
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // This loop now only ensures the menu closes when a link is clicked,
            // relying on the <a> tag's default behavior for navigation.
            const navLinks = document.querySelectorAll('.mobile-menu a.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    // Close the menu immediately when an active link is clicked
                    toggleMobileMenu();
                });
            });
            
            // NOTE: The click event for 'hamburger' is handled by the 
            // inline 'onclick="toggleMobileMenu()"' in the HTML for simplicity.
        });

window.addEventListener('beforeunload', saveChat);

    </script>
    <script src="scripts/scroll-animation.js"></script>
    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD59PBKVQ_ocfAxWHsMsG0a3SE143Yp5zo",
    authDomain: "taxc-ebooks.firebaseapp.com",
    projectId: "taxc-ebooks",
    storageBucket: "taxc-ebooks.firebasestorage.app",
    messagingSenderId: "542476707940",
    appId: "1:542476707940:web:591fd5d3d6fd51eff95771"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const $ = id => document.getElementById(id);

  onAuthStateChanged(auth, user => {
    const loginBtns = document.querySelectorAll('#auth-button, #auth-button-mobile');
    const userDisplay = $('userDisplay');

    if (user && user.displayName) {
      const firstName = user.displayName.split(' ')[0];
      userDisplay.textContent = `Hi, ${firstName}!`;
      userDisplay.style.display = 'inline';
    } else {
      userDisplay.style.display = 'none';
    }

    // KEEP ORIGINAL LOGIN/LOGOUT BUTTON LOGIC
    loginBtns.forEach(btn => {
      if (user) {
        btn.innerHTML = 'Logout';
        btn.onclick = () => signOut(auth).then(() => location.reload());
      } else {
        btn.innerHTML = 'Login';
        btn.onclick = () => location.href = 'login.html?redirect=' + encodeURIComponent(location.href);
      }
    });
  });
</script>
</body>
</html>